/**
 * Minified by jsDelivr using Terser v5.7.1.
 * Original file: /npm/monaco-editor@0.27.0/esm/vs/language/html/_deps/vscode-html-languageservice/services/htmlLinks.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import{createScanner}from"../parser/htmlScanner.js";import*as strings from"../utils/strings.js";import{URI as Uri}from"./../../vscode-uri/index.js";import{TokenType,Range}from"../htmlLanguageTypes.js";function normalizeRef(e){var t=e[0];return t!==e[e.length-1]||"'"!==t&&'"'!==t||(e=e.substr(1,e.length-2)),e}function validateRef(e,t){return!!e.length&&(("handlebars"!==t||!/{{.*}}/.test(e))&&/\b(w[\w\d+.-]*:\/\/)?[^\s()<>]+(?:\([\w\d]+\)|([^[:punct:]\s]|\/?))/.test(e))}function getWorkspaceUrl(e,t,r,n){if(!/^\s*javascript\:/i.test(t)&&!/[\n\r]/.test(t))return t=t.replace(/^\s*/g,""),/^https?:\/\//i.test(t)||/^file:\/\//i.test(t)?t:/^\#/i.test(t)?e+t:/^\/\//i.test(t)?(strings.startsWith(e,"https://")?"https":"http")+":"+t.replace(/^\s*/g,""):r?r.resolveReference(t,n||e):t}function createLink(e,t,r,n,a,i){var s=normalizeRef(r);if(validateRef(s,e.languageId)){s.length<r.length&&(n++,a--);var o=getWorkspaceUrl(e.uri,s,t,i);if(o&&isValidURI(o))return{range:Range.create(e.positionAt(n),e.positionAt(a)),target:o}}}function isValidURI(e){try{return Uri.parse(e),!0}catch(e){return!1}}export function findDocumentLinks(e,t){for(var r=[],n=createScanner(e.getText(),0),a=n.scan(),i=void 0,s=!1,o=void 0,f={};a!==TokenType.EOS;){switch(a){case TokenType.StartTag:if(!o)s="base"===n.getTokenText().toLowerCase();break;case TokenType.AttributeName:i=n.getTokenText().toLowerCase();break;case TokenType.AttributeValue:if("src"===i||"href"===i){var g=n.getTokenText();if(!s)(u=createLink(e,t,g,n.getTokenOffset(),n.getTokenEnd(),o))&&r.push(u);s&&void 0===o&&(o=normalizeRef(g))&&t&&(o=t.resolveReference(o,e.uri)),s=!1,i=void 0}else if("id"===i){f[normalizeRef(n.getTokenText())]=n.getTokenOffset()}}a=n.scan()}for(var c=0,l=r;c<l.length;c++){var u=l[c],p=e.uri+"#";if(u.target&&strings.startsWith(u.target,p)){var T=f[u.target.substr(p.length)];if(void 0!==T){var h=e.positionAt(T);u.target=""+p+(h.line+1)+","+(h.character+1)}}}return r}
//# sourceMappingURL=/sm/5403b792fb97bb24f97d90ee721101b2c1793e1e99fb2825075e0c345dc0f9d9.map