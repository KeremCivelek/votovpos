/**
 * Minified by jsDelivr using Terser v5.7.1.
 * Original file: /npm/monaco-editor@0.27.0/esm/vs/language/html/_deps/vscode-html-languageservice/parser/htmlParser.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import{createScanner}from"./htmlScanner.js";import{findFirst}from"../utils/arrays.js";import{TokenType}from"../htmlLanguageTypes.js";import{isVoidElement}from"../languageFacts/fact.js";var Node=function(){function e(e,t,n,r){this.start=e,this.end=t,this.children=n,this.parent=r,this.closed=!1}return Object.defineProperty(e.prototype,"attributeNames",{get:function(){return this.attributes?Object.keys(this.attributes):[]},enumerable:!1,configurable:!0}),e.prototype.isSameTag=function(e){return void 0===this.tag?void 0===e:void 0!==e&&this.tag.length===e.length&&this.tag.toLowerCase()===e},Object.defineProperty(e.prototype,"firstChild",{get:function(){return this.children[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastChild",{get:function(){return this.children.length?this.children[this.children.length-1]:void 0},enumerable:!1,configurable:!0}),e.prototype.findNodeBefore=function(e){var t=findFirst(this.children,(function(t){return e<=t.start}))-1;if(t>=0){var n=this.children[t];if(e>n.start){if(e<n.end)return n.findNodeBefore(e);var r=n.lastChild;return r&&r.end===n.end?n.findNodeBefore(e):n}}return this},e.prototype.findNodeAt=function(e){var t=findFirst(this.children,(function(t){return e<=t.start}))-1;if(t>=0){var n=this.children[t];if(e>n.start&&e<=n.end)return n.findNodeAt(e)}return this},e}();export{Node};export function parse(e){for(var t=createScanner(e,void 0,void 0,!0),n=new Node(0,e.length,[],void 0),r=n,o=-1,a=void 0,i=null,d=t.scan();d!==TokenType.EOS;){switch(d){case TokenType.StartTagOpen:var s=new Node(t.getTokenOffset(),e.length,[],r);r.children.push(s),r=s;break;case TokenType.StartTag:r.tag=t.getTokenText();break;case TokenType.StartTagClose:r.parent&&(r.end=t.getTokenEnd(),t.getTokenLength()?(r.startTagEnd=t.getTokenEnd(),r.tag&&isVoidElement(r.tag)&&(r.closed=!0,r=r.parent)):r=r.parent);break;case TokenType.StartTagSelfClose:r.parent&&(r.closed=!0,r.end=t.getTokenEnd(),r.startTagEnd=t.getTokenEnd(),r=r.parent);break;case TokenType.EndTagOpen:o=t.getTokenOffset(),a=void 0;break;case TokenType.EndTag:a=t.getTokenText().toLowerCase();break;case TokenType.EndTagClose:for(var f=r;!f.isSameTag(a)&&f.parent;)f=f.parent;if(f.parent){for(;r!==f;)r.end=o,r.closed=!1,r=r.parent;r.closed=!0,r.endTagStart=o,r.end=t.getTokenEnd(),r=r.parent}break;case TokenType.AttributeName:i=t.getTokenText(),(c=r.attributes)||(r.attributes=c={}),c[i]=null;break;case TokenType.AttributeValue:var c,l=t.getTokenText();(c=r.attributes)&&i&&(c[i]=l,i=null)}d=t.scan()}for(;r.parent;)r.end=e.length,r.closed=!1,r=r.parent;return{roots:n.children,findNodeBefore:n.findNodeBefore.bind(n),findNodeAt:n.findNodeAt.bind(n)}}
//# sourceMappingURL=/sm/6f1d4991fd5da4144166ae178b864d8ddd2402d3c5a623df26d4076d10ae7ec9.map