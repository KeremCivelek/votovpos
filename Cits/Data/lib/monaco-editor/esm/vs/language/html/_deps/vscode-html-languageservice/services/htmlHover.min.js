/**
 * Minified by jsDelivr using Terser v5.7.1.
 * Original file: /npm/monaco-editor@0.27.0/esm/vs/language/html/_deps/vscode-html-languageservice/services/htmlHover.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import{createScanner}from"../parser/htmlScanner.js";import{TokenType,Range,Position,MarkupKind}from"../htmlLanguageTypes.js";import{isDefined}from"../utils/object.js";import{generateDocumentation}from"../languageFacts/dataProvider.js";import{entities}from"../parser/htmlEntities.js";import{isLetterOrDigit}from"../utils/strings.js";import*as nls from"./../../../fillers/vscode-nls.js";var localize=nls.loadMessageBundle(),HTMLHover=function(){function t(t,e){this.lsOptions=t,this.dataManager=e}return t.prototype.doHover=function(t,e,n,r){var i=this.convertContents.bind(this),o=this.doesSupportMarkdown(),a=t.offsetAt(e),s=n.findNodeAt(a),u=t.getText();if(!s||!s.tag)return null;var l=this.dataManager.getDataProviders().filter((function(e){return e.isApplicable(t.languageId)}));function f(t,e,n){for(var a=function(n){var a=null;if(n.provideTags().forEach((function(n){if(n.name.toLowerCase()===t.toLowerCase()){var i=generateDocumentation(n,r,o);i||(i={kind:o?"markdown":"plaintext",value:""}),a={contents:i,range:e}}})),a)return a.contents=i(a.contents),{value:a}},s=0,u=l;s<u.length;s++){var f=a(u[s]);if("object"==typeof f)return f.value}return null}function c(e,n){for(var r=createScanner(t.getText(),n),i=r.scan();i!==TokenType.EOS&&(r.getTokenEnd()<a||r.getTokenEnd()===a&&i!==e);)i=r.scan();return i===e&&a<=r.getTokenEnd()?{start:t.positionAt(r.getTokenOffset()),end:t.positionAt(r.getTokenEnd())}:null}if(s.endTagStart&&a>=s.endTagStart){var p=c(TokenType.EndTag,s.endTagStart);return p?f(s.tag,p):null}var v=c(TokenType.StartTag,s.start);if(v)return f(s.tag,v);var g=c(TokenType.AttributeName,s.start);if(g)return function(t,e,n){for(var a=function(a){var s=null;if(a.provideAttributes(t).forEach((function(t){if(e===t.name&&t.description){var i=generateDocumentation(t,r,o);s=i?{contents:i,range:n}:null}})),s)return s.contents=i(s.contents),{value:s}},s=0,u=l;s<u.length;s++){var f=a(u[s]);if("object"==typeof f)return f.value}return null}(h=s.tag,t.getText(g),g);var d=function(){for(var t=a-1,n=e.character;t>=0&&isLetterOrDigit(u,t);)t--,n--;for(var r=t+1,i=n;isLetterOrDigit(u,r);)r++,i++;if(t>=0&&"&"===u[t]){return";"===u[r]?Range.create(Position.create(e.line,n),Position.create(e.line,i+1)):Range.create(Position.create(e.line,n),Position.create(e.line,i))}return null}();if(d)return function(t,e){var n=function(t){for(var e=a-1,n="&";e>=0&&isLetterOrDigit(t,e);)e--;for(e+=1;isLetterOrDigit(t,e);)n+=t[e],e+=1;return n+";"}(t);for(var r in entities){var o=null;if(n==="&"+r){var s=entities[r].charCodeAt(0).toString(16).toUpperCase(),u="U+";if(s.length<4)for(var l=4-s.length,f=0;f<l;)u+="0",f+=1;u+=s;var c=localize("entity.propose","Character entity representing '"+entities[r]+"', unicode equivalent '"+u+"'");o=c?{contents:c,range:e}:null}if(o)return o.contents=i(o.contents),o}return null}(u,d);var T=c(TokenType.AttributeValue,s.start);if(T){var h=s.tag,m=trimQuotes(t.getText(T)),k=function(e,n){for(var r=createScanner(t.getText(),e),i=r.scan(),o=void 0;i!==TokenType.EOS&&r.getTokenEnd()<=n;)(i=r.scan())===TokenType.AttributeName&&(o=r.getTokenText());return o}(s.start,t.offsetAt(T.start));if(k)return function(t,e,n,a){for(var s=function(s){var u=null;if(s.provideValues(t,e).forEach((function(t){if(n===t.name&&t.description){var e=generateDocumentation(t,r,o);u=e?{contents:e,range:a}:null}})),u)return u.contents=i(u.contents),{value:u}},u=0,f=l;u<f.length;u++){var c=s(f[u]);if("object"==typeof c)return c.value}return null}(h,k,m,T)}return null},t.prototype.convertContents=function(t){if(!this.doesSupportMarkdown()){if("string"==typeof t)return t;if("kind"in t)return{kind:"plaintext",value:t.value};if(!Array.isArray(t))return t.value;t.map((function(t){return"string"==typeof t?t:t.value}))}return t},t.prototype.doesSupportMarkdown=function(){var t,e,n;if(!isDefined(this.supportsMarkdown)){if(!isDefined(this.lsOptions.clientCapabilities))return this.supportsMarkdown=!0,this.supportsMarkdown;var r=null===(n=null===(e=null===(t=this.lsOptions.clientCapabilities)||void 0===t?void 0:t.textDocument)||void 0===e?void 0:e.hover)||void 0===n?void 0:n.contentFormat;this.supportsMarkdown=Array.isArray(r)&&-1!==r.indexOf(MarkupKind.Markdown)}return this.supportsMarkdown},t}();export{HTMLHover};function trimQuotes(t){return t.length<=1?t.replace(/['"]/,""):("'"!==t[0]&&'"'!==t[0]||(t=t.slice(1)),"'"!==t[t.length-1]&&'"'!==t[t.length-1]||(t=t.slice(0,-1)),t)}
//# sourceMappingURL=/sm/e7146d914d8c32bd04b3010623cb6ecd8cf0fbf024b58f88e92b6576f81a2b8b.map