/**
 * Minified by jsDelivr using Terser v5.7.1.
 * Original file: /npm/monaco-editor@0.27.0/esm/vs/language/html/_deps/vscode-html-languageservice/services/htmlFolding.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import{TokenType,FoldingRangeKind}from"../htmlLanguageTypes.js";import{createScanner}from"../parser/htmlScanner.js";import{isVoidElement}from"../languageFacts/fact.js";function limitRanges(e,n){e=e.sort((function(e,n){var t=e.startLine-n.startLine;return 0===t&&(t=e.endLine-n.endLine),t}));for(var t=void 0,i=[],a=[],r=[],o=function(e,n){a[e]=n,n<30&&(r[n]=(r[n]||0)+1)},s=0;s<e.length;s++){var g=e[s];if(t){if(g.startLine>t.startLine)if(g.endLine<=t.endLine)i.push(t),t=g,o(s,i.length);else if(g.startLine>t.endLine){do{t=i.pop()}while(t&&g.startLine>t.endLine);t&&i.push(t),t=g,o(s,i.length)}}else t=g,o(s,0)}var l=0,f=0;for(s=0;s<r.length;s++){var T=r[s];if(T){if(T+l>n){f=s;break}l+=T}}var p=[];for(s=0;s<e.length;s++){var L=a[s];"number"==typeof L&&(L<f||L===f&&l++<n)&&p.push(e[s])}return p}export function getFoldingRanges(e,n){var t=createScanner(e.getText()),i=t.scan(),a=[],r=[],o=null,s=-1;function g(e){a.push(e),s=e.startLine}for(;i!==TokenType.EOS;){switch(i){case TokenType.StartTag:var l=t.getTokenText(),f=e.positionAt(t.getTokenOffset()).line;r.push({startLine:f,tagName:l}),o=l;break;case TokenType.EndTag:o=t.getTokenText();break;case TokenType.StartTagClose:if(!o||!isVoidElement(o))break;case TokenType.EndTagClose:case TokenType.StartTagSelfClose:for(var T=r.length-1;T>=0&&r[T].tagName!==o;)T--;if(T>=0){var p=r[T];r.length=T,(d=e.positionAt(t.getTokenOffset()).line-1)>(f=p.startLine)&&s!==f&&g({startLine:f,endLine:d})}break;case TokenType.Comment:f=e.positionAt(t.getTokenOffset()).line;var L=t.getTokenText().match(/^\s*#(region\b)|(endregion\b)/);if(L)if(L[1])r.push({startLine:f,tagName:""});else{for(T=r.length-1;T>=0&&r[T].tagName.length;)T--;if(T>=0){var d;p=r[T];r.length=T,(d=f)>(f=p.startLine)&&s!==f&&g({startLine:f,endLine:d,kind:FoldingRangeKind.Region})}}else f<(d=e.positionAt(t.getTokenOffset()+t.getTokenLength()).line)&&g({startLine:f,endLine:d,kind:FoldingRangeKind.Comment})}i=t.scan()}var m=n&&n.rangeLimit||Number.MAX_VALUE;return a.length>m?limitRanges(a,m):a}
//# sourceMappingURL=/sm/2513475291533a6fc0413fae396e98dd4795f105fe1b8a5af674f770d844c39f.map