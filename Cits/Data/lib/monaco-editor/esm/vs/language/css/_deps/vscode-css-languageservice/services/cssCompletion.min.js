/**
 * Minified by jsDelivr using Terser v5.7.1.
 * Original file: /npm/monaco-editor@0.27.0/esm/vs/language/css/_deps/vscode-css-languageservice/services/cssCompletion.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
"use strict";var __awaiter=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))((function(i,r){function s(t){try{l(n.next(t))}catch(t){r(t)}}function a(t){try{l(n.throw(t))}catch(t){r(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(s,a)}l((n=n.apply(t,e||[])).next())}))},__generator=this&&this.__generator||function(t,e){var o,n,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,n=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){s=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){s.label=r[1];break}if(6===r[0]&&s.label<i[1]){s.label=i[1],i=r;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(r);break}i[2]&&s.ops.pop(),s.trys.pop();continue}r=e.call(t,s)}catch(t){r=[6,t],n=0}finally{o=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}};import*as nodes from"../parser/cssNodes.js";import{Symbols}from"../parser/cssSymbolScope.js";import*as languageFacts from"../languageFacts/facts.js";import*as strings from"../utils/strings.js";import{Position,CompletionItemKind,Range,TextEdit,InsertTextFormat,MarkupKind,CompletionItemTag}from"../cssLanguageTypes.js";import*as nls from"./../../../fillers/vscode-nls.js";import{isDefined}from"../utils/objects.js";import{PathCompletionParticipant}from"./pathCompletion.js";var SortTexts,localize=nls.loadMessageBundle(),SnippetFormat=InsertTextFormat.Snippet;!function(t){t.Enums=" ",t.Normal="d",t.VendorPrefixed="x",t.Term="y",t.Variable="z"}(SortTexts||(SortTexts={}));var CSSCompletion=function(){function t(t,e,o){void 0===t&&(t=null),this.variablePrefix=t,this.lsOptions=e,this.cssDataManager=o,this.completionParticipants=[]}return t.prototype.configure=function(t){this.defaultSettings=t},t.prototype.getSymbolContext=function(){return this.symbolContext||(this.symbolContext=new Symbols(this.styleSheet)),this.symbolContext},t.prototype.setCompletionParticipants=function(t){this.completionParticipants=t||[]},t.prototype.doComplete2=function(t,e,o,n,i){return void 0===i&&(i=this.defaultSettings),__awaiter(this,void 0,void 0,(function(){var r,s,a,l;return __generator(this,(function(p){switch(p.label){case 0:if(!this.lsOptions.fileSystemProvider||!this.lsOptions.fileSystemProvider.readDirectory)return[2,this.doComplete(t,e,o,i)];r=new PathCompletionParticipant(this.lsOptions.fileSystemProvider.readDirectory),s=this.completionParticipants,this.completionParticipants=[r].concat(s),a=this.doComplete(t,e,o,i),p.label=1;case 1:return p.trys.push([1,,3,4]),[4,r.computeCompletions(t,n)];case 2:return l=p.sent(),[2,{isIncomplete:a.isIncomplete||l.isIncomplete,items:l.items.concat(a.items)}];case 3:return this.completionParticipants=s,[7];case 4:return[2]}}))}))},t.prototype.doComplete=function(t,e,o,n){this.offset=t.offsetAt(e),this.position=e,this.currentWord=getCurrentWord(t,this.offset),this.defaultReplaceRange=Range.create(Position.create(this.position.line,this.position.character-this.currentWord.length),this.position),this.textDocument=t,this.styleSheet=o,this.documentSettings=n;try{var i={isIncomplete:!1,items:[]};this.nodePath=nodes.getNodePath(this.styleSheet,this.offset);for(var r=this.nodePath.length-1;r>=0;r--){var s=this.nodePath[r];if(s instanceof nodes.Property)this.getCompletionsForDeclarationProperty(s.getParent(),i);else if(s instanceof nodes.Expression)s.parent instanceof nodes.Interpolation?this.getVariableProposals(null,i):this.getCompletionsForExpression(s,i);else if(s instanceof nodes.SimpleSelector){var a=s.findAParent(nodes.NodeType.ExtendsReference,nodes.NodeType.Ruleset);if(a)if(a.type===nodes.NodeType.ExtendsReference)this.getCompletionsForExtendsReference(a,s,i);else{var l=a;this.getCompletionsForSelector(l,l&&l.isNested(),i)}}else if(s instanceof nodes.FunctionArgument)this.getCompletionsForFunctionArgument(s,s.getParent(),i);else if(s instanceof nodes.Declarations)this.getCompletionsForDeclarations(s,i);else if(s instanceof nodes.VariableDeclaration)this.getCompletionsForVariableDeclaration(s,i);else if(s instanceof nodes.RuleSet)this.getCompletionsForRuleSet(s,i);else if(s instanceof nodes.Interpolation)this.getCompletionsForInterpolation(s,i);else if(s instanceof nodes.FunctionDeclaration)this.getCompletionsForFunctionDeclaration(s,i);else if(s instanceof nodes.MixinReference)this.getCompletionsForMixinReference(s,i);else if(s instanceof nodes.Function)this.getCompletionsForFunctionArgument(null,s,i);else if(s instanceof nodes.Supports)this.getCompletionsForSupports(s,i);else if(s instanceof nodes.SupportsCondition)this.getCompletionsForSupportsCondition(s,i);else if(s instanceof nodes.ExtendsReference)this.getCompletionsForExtendsReference(s,null,i);else if(s.type===nodes.NodeType.URILiteral)this.getCompletionForUriLiteralValue(s,i);else if(null===s.parent)this.getCompletionForTopLevel(i);else{if(s.type!==nodes.NodeType.StringLiteral||!this.isImportPathParent(s.parent.type))continue;this.getCompletionForImportPath(s,i)}if(i.items.length>0||this.offset>s.offset)return this.finalize(i)}return this.getCompletionsForStylesheet(i),0===i.items.length&&this.variablePrefix&&0===this.currentWord.indexOf(this.variablePrefix)&&this.getVariableProposals(null,i),this.finalize(i)}finally{this.position=null,this.currentWord=null,this.textDocument=null,this.styleSheet=null,this.symbolContext=null,this.defaultReplaceRange=null,this.nodePath=null}},t.prototype.isImportPathParent=function(t){return t===nodes.NodeType.Import},t.prototype.finalize=function(t){return t},t.prototype.findInNodePath=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var o=this.nodePath.length-1;o>=0;o--){var n=this.nodePath[o];if(-1!==t.indexOf(n.type))return n}return null},t.prototype.getCompletionsForDeclarationProperty=function(t,e){return this.getPropertyProposals(t,e)},t.prototype.getPropertyProposals=function(t,e){var o=this,n=this.isTriggerPropertyValueCompletionEnabled,i=this.isCompletePropertyWithSemicolonEnabled;return this.cssDataManager.getProperties().forEach((function(r){var s,a,l=!1;t?(s=o.getCompletionRange(t.getProperty()),a=r.name,isDefined(t.colonPosition)||(a+=": ",l=!0)):(s=o.getCompletionRange(null),a=r.name+": ",l=!0),!t&&i&&(a+="$0;"),t&&!t.semicolonPosition&&i&&o.offset>=o.textDocument.offsetAt(s.end)&&(a+="$0;");var p={label:r.name,documentation:languageFacts.getEntryDescription(r,o.doesSupportMarkdown()),tags:isDeprecated(r)?[CompletionItemTag.Deprecated]:[],textEdit:TextEdit.replace(s,a),insertTextFormat:InsertTextFormat.Snippet,kind:CompletionItemKind.Property};r.restrictions||(l=!1),n&&l&&(p.command={title:"Suggest",command:"editor.action.triggerSuggest"});var c=(255-("number"==typeof r.relevance?Math.min(Math.max(r.relevance,0),99):50)).toString(16),u=strings.startsWith(r.name,"-")?SortTexts.VendorPrefixed:SortTexts.Normal;p.sortText=u+"_"+c,e.items.push(p)})),this.completionParticipants.forEach((function(t){t.onCssProperty&&t.onCssProperty({propertyName:o.currentWord,range:o.defaultReplaceRange})})),e},Object.defineProperty(t.prototype,"isTriggerPropertyValueCompletionEnabled",{get:function(){var t,e;return null===(e=null===(t=this.documentSettings)||void 0===t?void 0:t.triggerPropertyValueCompletion)||void 0===e||e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isCompletePropertyWithSemicolonEnabled",{get:function(){var t,e;return null===(e=null===(t=this.documentSettings)||void 0===t?void 0:t.completePropertyWithSemicolon)||void 0===e||e},enumerable:!1,configurable:!0}),t.prototype.getCompletionsForDeclarationValue=function(t,e){for(var o=this,n=t.getFullPropertyName(),i=this.cssDataManager.getProperty(n),r=t.getValue()||null;r&&r.hasChildren();)r=r.findChildAtOffset(this.offset,!1);if(this.completionParticipants.forEach((function(t){t.onCssPropertyValue&&t.onCssPropertyValue({propertyName:n,propertyValue:o.currentWord,range:o.getCompletionRange(r)})})),i){if(i.restrictions)for(var s=0,a=i.restrictions;s<a.length;s++){switch(a[s]){case"color":this.getColorProposals(i,r,e);break;case"position":this.getPositionProposals(i,r,e);break;case"repeat":this.getRepeatStyleProposals(i,r,e);break;case"line-style":this.getLineStyleProposals(i,r,e);break;case"line-width":this.getLineWidthProposals(i,r,e);break;case"geometry-box":this.getGeometryBoxProposals(i,r,e);break;case"box":this.getBoxProposals(i,r,e);break;case"image":this.getImageProposals(i,r,e);break;case"timing-function":this.getTimingFunctionProposals(i,r,e);break;case"shape":this.getBasicShapeProposals(i,r,e)}}this.getValueEnumProposals(i,r,e),this.getCSSWideKeywordProposals(i,r,e),this.getUnitProposals(i,r,e)}else for(var l=0,p=collectValues(this.styleSheet,t).getEntries();l<p.length;l++){var c=p[l];e.items.push({label:c,textEdit:TextEdit.replace(this.getCompletionRange(r),c),kind:CompletionItemKind.Value})}return this.getVariableProposals(r,e),this.getTermProposals(i,r,e),e},t.prototype.getValueEnumProposals=function(t,e,o){if(t.values)for(var n=0,i=t.values;n<i.length;n++){var r=i[n],s=r.name,a=void 0;if(strings.endsWith(s,")")){var l=s.lastIndexOf("(");-1!==l&&(s=s.substr(0,l)+"($1)",a=SnippetFormat)}var p=SortTexts.Enums;strings.startsWith(r.name,"-")&&(p+=SortTexts.VendorPrefixed);var c={label:r.name,documentation:languageFacts.getEntryDescription(r,this.doesSupportMarkdown()),tags:isDeprecated(t)?[CompletionItemTag.Deprecated]:[],textEdit:TextEdit.replace(this.getCompletionRange(e),s),sortText:p,kind:CompletionItemKind.Value,insertTextFormat:a};o.items.push(c)}return o},t.prototype.getCSSWideKeywordProposals=function(t,e,o){for(var n in languageFacts.cssWideKeywords)o.items.push({label:n,documentation:languageFacts.cssWideKeywords[n],textEdit:TextEdit.replace(this.getCompletionRange(e),n),kind:CompletionItemKind.Value});return o},t.prototype.getCompletionsForInterpolation=function(t,e){return this.offset>=t.offset+2&&this.getVariableProposals(null,e),e},t.prototype.getVariableProposals=function(t,e){for(var o=0,n=this.getSymbolContext().findSymbolsAtOffset(this.offset,nodes.ReferenceType.Variable);o<n.length;o++){var i=n[o],r=strings.startsWith(i.name,"--")?"var("+i.name+")":i.name,s={label:i.name,documentation:i.value?strings.getLimitedString(i.value):i.value,textEdit:TextEdit.replace(this.getCompletionRange(t),r),kind:CompletionItemKind.Variable,sortText:SortTexts.Variable};if("string"==typeof s.documentation&&isColorString(s.documentation)&&(s.kind=CompletionItemKind.Color),i.node.type===nodes.NodeType.FunctionParameter){var a=i.node.getParent();a.type===nodes.NodeType.MixinDeclaration&&(s.detail=localize("completion.argument","argument from '{0}'",a.getName()))}e.items.push(s)}return e},t.prototype.getVariableProposalsForCSSVarFunction=function(t){for(var e=this.getSymbolContext().findSymbolsAtOffset(this.offset,nodes.ReferenceType.Variable),o=0,n=e=e.filter((function(t){return strings.startsWith(t.name,"--")}));o<n.length;o++){var i=n[o],r={label:i.name,documentation:i.value?strings.getLimitedString(i.value):i.value,textEdit:TextEdit.replace(this.getCompletionRange(null),i.name),kind:CompletionItemKind.Variable};"string"==typeof r.documentation&&isColorString(r.documentation)&&(r.kind=CompletionItemKind.Color),t.items.push(r)}return t},t.prototype.getUnitProposals=function(t,e,o){var n="0";if(this.currentWord.length>0){var i=this.currentWord.match(/^-?\d[\.\d+]*/);i&&(n=i[0],o.isIncomplete=n.length===this.currentWord.length)}else 0===this.currentWord.length&&(o.isIncomplete=!0);if(e&&e.parent&&e.parent.type===nodes.NodeType.Term&&(e=e.getParent()),t.restrictions)for(var r=0,s=t.restrictions;r<s.length;r++){var a=s[r],l=languageFacts.units[a];if(l)for(var p=0,c=l;p<c.length;p++){var u=n+c[p];o.items.push({label:u,textEdit:TextEdit.replace(this.getCompletionRange(e),u),kind:CompletionItemKind.Unit})}}return o},t.prototype.getCompletionRange=function(t){if(t&&t.offset<=this.offset&&this.offset<=t.end){var e=-1!==t.end?this.textDocument.positionAt(t.end):this.position,o=this.textDocument.positionAt(t.offset);if(o.line===e.line)return Range.create(o,e)}return this.defaultReplaceRange},t.prototype.getColorProposals=function(t,e,o){for(var n in languageFacts.colors)o.items.push({label:n,documentation:languageFacts.colors[n],textEdit:TextEdit.replace(this.getCompletionRange(e),n),kind:CompletionItemKind.Color});for(var n in languageFacts.colorKeywords)o.items.push({label:n,documentation:languageFacts.colorKeywords[n],textEdit:TextEdit.replace(this.getCompletionRange(e),n),kind:CompletionItemKind.Value});var i=new Set;this.styleSheet.acceptVisitor(new ColorValueCollector(i,this.offset));for(var r=0,s=i.getEntries();r<s.length;r++){n=s[r];o.items.push({label:n,textEdit:TextEdit.replace(this.getCompletionRange(e),n),kind:CompletionItemKind.Color})}for(var a=function(t){var n=1,i=t.func.replace(/\[?\$(\w+)\]?/g,(function(t,e){return"${"+n+++":"+e+"}"}));o.items.push({label:t.func.substr(0,t.func.indexOf("(")),detail:t.func,documentation:t.desc,textEdit:TextEdit.replace(l.getCompletionRange(e),i),insertTextFormat:SnippetFormat,kind:CompletionItemKind.Function})},l=this,p=0,c=languageFacts.colorFunctions;p<c.length;p++){a(c[p])}return o},t.prototype.getPositionProposals=function(t,e,o){for(var n in languageFacts.positionKeywords)o.items.push({label:n,documentation:languageFacts.positionKeywords[n],textEdit:TextEdit.replace(this.getCompletionRange(e),n),kind:CompletionItemKind.Value});return o},t.prototype.getRepeatStyleProposals=function(t,e,o){for(var n in languageFacts.repeatStyleKeywords)o.items.push({label:n,documentation:languageFacts.repeatStyleKeywords[n],textEdit:TextEdit.replace(this.getCompletionRange(e),n),kind:CompletionItemKind.Value});return o},t.prototype.getLineStyleProposals=function(t,e,o){for(var n in languageFacts.lineStyleKeywords)o.items.push({label:n,documentation:languageFacts.lineStyleKeywords[n],textEdit:TextEdit.replace(this.getCompletionRange(e),n),kind:CompletionItemKind.Value});return o},t.prototype.getLineWidthProposals=function(t,e,o){for(var n=0,i=languageFacts.lineWidthKeywords;n<i.length;n++){var r=i[n];o.items.push({label:r,textEdit:TextEdit.replace(this.getCompletionRange(e),r),kind:CompletionItemKind.Value})}return o},t.prototype.getGeometryBoxProposals=function(t,e,o){for(var n in languageFacts.geometryBoxKeywords)o.items.push({label:n,documentation:languageFacts.geometryBoxKeywords[n],textEdit:TextEdit.replace(this.getCompletionRange(e),n),kind:CompletionItemKind.Value});return o},t.prototype.getBoxProposals=function(t,e,o){for(var n in languageFacts.boxKeywords)o.items.push({label:n,documentation:languageFacts.boxKeywords[n],textEdit:TextEdit.replace(this.getCompletionRange(e),n),kind:CompletionItemKind.Value});return o},t.prototype.getImageProposals=function(t,e,o){for(var n in languageFacts.imageFunctions){var i=moveCursorInsideParenthesis(n);o.items.push({label:n,documentation:languageFacts.imageFunctions[n],textEdit:TextEdit.replace(this.getCompletionRange(e),i),kind:CompletionItemKind.Function,insertTextFormat:n!==i?SnippetFormat:void 0})}return o},t.prototype.getTimingFunctionProposals=function(t,e,o){for(var n in languageFacts.transitionTimingFunctions){var i=moveCursorInsideParenthesis(n);o.items.push({label:n,documentation:languageFacts.transitionTimingFunctions[n],textEdit:TextEdit.replace(this.getCompletionRange(e),i),kind:CompletionItemKind.Function,insertTextFormat:n!==i?SnippetFormat:void 0})}return o},t.prototype.getBasicShapeProposals=function(t,e,o){for(var n in languageFacts.basicShapeFunctions){var i=moveCursorInsideParenthesis(n);o.items.push({label:n,documentation:languageFacts.basicShapeFunctions[n],textEdit:TextEdit.replace(this.getCompletionRange(e),i),kind:CompletionItemKind.Function,insertTextFormat:n!==i?SnippetFormat:void 0})}return o},t.prototype.getCompletionsForStylesheet=function(t){var e=this.styleSheet.findFirstChildBeforeOffset(this.offset);return e?e instanceof nodes.RuleSet?this.getCompletionsForRuleSet(e,t):e instanceof nodes.Supports?this.getCompletionsForSupports(e,t):t:this.getCompletionForTopLevel(t)},t.prototype.getCompletionForTopLevel=function(t){var e=this;return this.cssDataManager.getAtDirectives().forEach((function(o){t.items.push({label:o.name,textEdit:TextEdit.replace(e.getCompletionRange(null),o.name),documentation:languageFacts.getEntryDescription(o,e.doesSupportMarkdown()),tags:isDeprecated(o)?[CompletionItemTag.Deprecated]:[],kind:CompletionItemKind.Keyword})})),this.getCompletionsForSelector(null,!1,t),t},t.prototype.getCompletionsForRuleSet=function(t,e){var o=t.getDeclarations();return o&&o.endsWith("}")&&this.offset>=o.end?this.getCompletionForTopLevel(e):!o||this.offset<=o.offset?this.getCompletionsForSelector(t,t.isNested(),e):this.getCompletionsForDeclarations(t.getDeclarations(),e)},t.prototype.getCompletionsForSelector=function(t,e,o){var n=this,i=this.findInNodePath(nodes.NodeType.PseudoSelector,nodes.NodeType.IdentifierSelector,nodes.NodeType.ClassSelector,nodes.NodeType.ElementNameSelector);if(!i&&this.hasCharacterAtPosition(this.offset-this.currentWord.length-1,":")&&(this.currentWord=":"+this.currentWord,this.hasCharacterAtPosition(this.offset-this.currentWord.length-1,":")&&(this.currentWord=":"+this.currentWord),this.defaultReplaceRange=Range.create(Position.create(this.position.line,this.position.character-this.currentWord.length),this.position)),this.cssDataManager.getPseudoClasses().forEach((function(t){var e=moveCursorInsideParenthesis(t.name),r={label:t.name,textEdit:TextEdit.replace(n.getCompletionRange(i),e),documentation:languageFacts.getEntryDescription(t,n.doesSupportMarkdown()),tags:isDeprecated(t)?[CompletionItemTag.Deprecated]:[],kind:CompletionItemKind.Function,insertTextFormat:t.name!==e?SnippetFormat:void 0};strings.startsWith(t.name,":-")&&(r.sortText=SortTexts.VendorPrefixed),o.items.push(r)})),this.cssDataManager.getPseudoElements().forEach((function(t){var e=moveCursorInsideParenthesis(t.name),r={label:t.name,textEdit:TextEdit.replace(n.getCompletionRange(i),e),documentation:languageFacts.getEntryDescription(t,n.doesSupportMarkdown()),tags:isDeprecated(t)?[CompletionItemTag.Deprecated]:[],kind:CompletionItemKind.Function,insertTextFormat:t.name!==e?SnippetFormat:void 0};strings.startsWith(t.name,"::-")&&(r.sortText=SortTexts.VendorPrefixed),o.items.push(r)})),!e){for(var r=0,s=languageFacts.html5Tags;r<s.length;r++){var a=s[r];o.items.push({label:a,textEdit:TextEdit.replace(this.getCompletionRange(i),a),kind:CompletionItemKind.Keyword})}for(var l=0,p=languageFacts.svgElements;l<p.length;l++){a=p[l];o.items.push({label:a,textEdit:TextEdit.replace(this.getCompletionRange(i),a),kind:CompletionItemKind.Keyword})}}var c={};c[this.currentWord]=!0;var u=this.textDocument.getText();if(this.styleSheet.accept((function(t){if(t.type===nodes.NodeType.SimpleSelector&&t.length>0){var e=u.substr(t.offset,t.length);return"."!==e.charAt(0)||c[e]||(c[e]=!0,o.items.push({label:e,textEdit:TextEdit.replace(n.getCompletionRange(i),e),kind:CompletionItemKind.Keyword})),!1}return!0})),t&&t.isNested()){var d=t.getSelectors().findFirstChildBeforeOffset(this.offset);d&&0===t.getSelectors().getChildren().indexOf(d)&&this.getPropertyProposals(null,o)}return o},t.prototype.getCompletionsForDeclarations=function(t,e){if(!t||this.offset===t.offset)return e;var o=t.findFirstChildBeforeOffset(this.offset);if(!o)return this.getCompletionsForDeclarationProperty(null,e);if(o instanceof nodes.AbstractDeclaration){var n=o;if(!isDefined(n.colonPosition)||this.offset<=n.colonPosition)return this.getCompletionsForDeclarationProperty(n,e);if(isDefined(n.semicolonPosition)&&n.semicolonPosition<this.offset)return this.offset===n.semicolonPosition+1?e:this.getCompletionsForDeclarationProperty(null,e);if(n instanceof nodes.Declaration)return this.getCompletionsForDeclarationValue(n,e)}else o instanceof nodes.ExtendsReference?this.getCompletionsForExtendsReference(o,null,e):(this.currentWord&&"@"===this.currentWord[0]||o instanceof nodes.RuleSet)&&this.getCompletionsForDeclarationProperty(null,e);return e},t.prototype.getCompletionsForVariableDeclaration=function(t,e){return this.offset&&isDefined(t.colonPosition)&&this.offset>t.colonPosition&&this.getVariableProposals(t.getValue(),e),e},t.prototype.getCompletionsForExpression=function(t,e){var o=t.getParent();if(o instanceof nodes.FunctionArgument)return this.getCompletionsForFunctionArgument(o,o.getParent(),e),e;var n=t.findParent(nodes.NodeType.Declaration);if(!n)return this.getTermProposals(void 0,null,e),e;var i=t.findChildAtOffset(this.offset,!0);return i?i instanceof nodes.NumericValue||i instanceof nodes.Identifier?this.getCompletionsForDeclarationValue(n,e):e:this.getCompletionsForDeclarationValue(n,e)},t.prototype.getCompletionsForFunctionArgument=function(t,e,o){var n=e.getIdentifier();return n&&n.matches("var")&&(e.getArguments().hasChildren()&&e.getArguments().getChild(0)!==t||this.getVariableProposalsForCSSVarFunction(o)),o},t.prototype.getCompletionsForFunctionDeclaration=function(t,e){var o=t.getDeclarations();return o&&this.offset>o.offset&&this.offset<o.end&&this.getTermProposals(void 0,null,e),e},t.prototype.getCompletionsForMixinReference=function(t,e){for(var o=this,n=0,i=this.getSymbolContext().findSymbolsAtOffset(this.offset,nodes.ReferenceType.Mixin);n<i.length;n++){var r=i[n];r.node instanceof nodes.MixinDeclaration&&e.items.push(this.makeTermProposal(r,r.node.getParameters(),null))}var s=t.getIdentifier()||null;return this.completionParticipants.forEach((function(t){t.onCssMixinReference&&t.onCssMixinReference({mixinName:o.currentWord,range:o.getCompletionRange(s)})})),e},t.prototype.getTermProposals=function(t,e,o){for(var n=0,i=this.getSymbolContext().findSymbolsAtOffset(this.offset,nodes.ReferenceType.Function);n<i.length;n++){var r=i[n];r.node instanceof nodes.FunctionDeclaration&&o.items.push(this.makeTermProposal(r,r.node.getParameters(),e))}return o},t.prototype.makeTermProposal=function(t,e,o){t.node;var n=e.getChildren().map((function(t){return t instanceof nodes.FunctionParameter?t.getName():t.getText()})),i=t.name+"("+n.map((function(t,e){return"${"+(e+1)+":"+t+"}"})).join(", ")+")";return{label:t.name,detail:t.name+"("+n.join(", ")+")",textEdit:TextEdit.replace(this.getCompletionRange(o),i),insertTextFormat:SnippetFormat,kind:CompletionItemKind.Function,sortText:SortTexts.Term}},t.prototype.getCompletionsForSupportsCondition=function(t,e){var o=t.findFirstChildBeforeOffset(this.offset);if(o){if(o instanceof nodes.Declaration)return!isDefined(o.colonPosition)||this.offset<=o.colonPosition?this.getCompletionsForDeclarationProperty(o,e):this.getCompletionsForDeclarationValue(o,e);if(o instanceof nodes.SupportsCondition)return this.getCompletionsForSupportsCondition(o,e)}return isDefined(t.lParent)&&this.offset>t.lParent&&(!isDefined(t.rParent)||this.offset<=t.rParent)?this.getCompletionsForDeclarationProperty(null,e):e},t.prototype.getCompletionsForSupports=function(t,e){var o=t.getDeclarations();if(!o||this.offset<=o.offset){var n=t.findFirstChildBeforeOffset(this.offset);return n instanceof nodes.SupportsCondition?this.getCompletionsForSupportsCondition(n,e):e}return this.getCompletionForTopLevel(e)},t.prototype.getCompletionsForExtendsReference=function(t,e,o){return o},t.prototype.getCompletionForUriLiteralValue=function(t,e){var o,n,i;if(t.hasChildren()){var r=t.getChild(0);o=r.getText(),n=this.position,i=this.getCompletionRange(r)}else{o="",n=this.position;var s=this.textDocument.positionAt(t.offset+"url(".length);i=Range.create(s,s)}return this.completionParticipants.forEach((function(t){t.onCssURILiteralValue&&t.onCssURILiteralValue({uriValue:o,position:n,range:i})})),e},t.prototype.getCompletionForImportPath=function(t,e){var o=this;return this.completionParticipants.forEach((function(e){e.onCssImportPath&&e.onCssImportPath({pathValue:t.getText(),position:o.position,range:o.getCompletionRange(t)})})),e},t.prototype.hasCharacterAtPosition=function(t,e){var o=this.textDocument.getText();return t>=0&&t<o.length&&o.charAt(t)===e},t.prototype.doesSupportMarkdown=function(){var t,e,o;if(!isDefined(this.supportsMarkdown)){if(!isDefined(this.lsOptions.clientCapabilities))return this.supportsMarkdown=!0,this.supportsMarkdown;var n=null===(o=null===(e=null===(t=this.lsOptions.clientCapabilities.textDocument)||void 0===t?void 0:t.completion)||void 0===e?void 0:e.completionItem)||void 0===o?void 0:o.documentationFormat;this.supportsMarkdown=Array.isArray(n)&&-1!==n.indexOf(MarkupKind.Markdown)}return this.supportsMarkdown},t}();export{CSSCompletion};function isDeprecated(t){return!(!t.status||"nonstandard"!==t.status&&"obsolete"!==t.status)}function computeRankNumber(t){var e=t.toString();switch(e.length){case 4:return e;case 3:return"0"+e;case 2:return"00"+e;case 1:return"000"+e;default:return"0000"}}var Set=function(){function t(){this.entries={}}return t.prototype.add=function(t){this.entries[t]=!0},t.prototype.getEntries=function(){return Object.keys(this.entries)},t}();function moveCursorInsideParenthesis(t){return t.replace(/\(\)$/,"($1)")}function collectValues(t,e){var o=e.getFullPropertyName(),n=new Set;function i(t){return(t instanceof nodes.Identifier||t instanceof nodes.NumericValue||t instanceof nodes.HexColorValue)&&n.add(t.getText()),!0}return t.accept((function(t){if(t instanceof nodes.Declaration&&t!==e&&(r=t.getFullPropertyName(),o===r)){var n=t.getValue();n&&n.accept(i)}var r;return!0})),n}var ColorValueCollector=function(){function t(t,e){this.entries=t,this.currentOffset=e}return t.prototype.visitNode=function(t){return(t instanceof nodes.HexColorValue||t instanceof nodes.Function&&languageFacts.isColorConstructor(t))&&(this.currentOffset<t.offset||t.end<this.currentOffset)&&this.entries.add(t.getText()),!0},t}();function getCurrentWord(t,e){for(var o=e-1,n=t.getText();o>=0&&-1===' \t\n\r":{[()]},*>+'.indexOf(n.charAt(o));)o--;return n.substring(o+1,e)}function isColorString(t){return t.toLowerCase()in languageFacts.colors||/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(t)}
//# sourceMappingURL=/sm/bd5b84635233f083b88ca2d6b5226f876256e14ce2278152465702c4bbb9e595.map