/**
 * Minified by jsDelivr using Terser v5.7.1.
 * Original file: /npm/monaco-editor@0.27.0/esm/vs/language/json/_deps/jsonc-parser/impl/edit.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
"use strict";import{format,isEOL}from"./format.js";import{parseTree,findNodeAtLocation}from"./parser.js";export function removeProperty(t,e,n){return setProperty(t,e,void 0,n)}export function setProperty(t,e,n,r){for(var o,i=e.slice(),f=parseTree(t,[]),h=void 0,l=void 0;i.length>0&&(l=i.pop(),void 0===(h=findNodeAtLocation(f,i))&&void 0!==n);)"string"==typeof l?((o={})[l]=n,n=o):n=[n];if(h){if("object"===h.type&&"string"==typeof l&&Array.isArray(h.children)){var s=findNodeAtLocation(h,[l]);if(void 0!==s){if(void 0===n){if(!s.parent)throw new Error("Malformed AST");var g=h.children.indexOf(s.parent),d=void 0,c=s.parent.offset+s.parent.length;if(g>0)d=(O=h.children[g-1]).offset+O.length;else if(d=h.offset+1,h.children.length>1)c=h.children[1].offset;return withFormatting(t,{offset:d,length:c-d,content:""},r)}return withFormatting(t,{offset:s.offset,length:s.length,content:JSON.stringify(n)},r)}if(void 0===n)return[];var a=JSON.stringify(l)+": "+JSON.stringify(n),p=void 0;return withFormatting(t,p=(A=r.getInsertionIndex?r.getInsertionIndex(h.children.map((function(t){return t.children[0].value}))):h.children.length)>0?{offset:(O=h.children[A-1]).offset+O.length,length:0,content:","+a}:0===h.children.length?{offset:h.offset+1,length:0,content:a}:{offset:h.offset+1,length:0,content:a+","},r)}if("array"===h.type&&"number"==typeof l&&Array.isArray(h.children)){var v=l;if(-1===v){a=""+JSON.stringify(n),p=void 0;if(0===h.children.length)p={offset:h.offset+1,length:0,content:a};else p={offset:(O=h.children[h.children.length-1]).offset+O.length,length:0,content:","+a};return withFormatting(t,p,r)}if(void 0===n&&h.children.length>=0){var y=l,u=h.children[y];p=void 0;if(1===h.children.length)p={offset:h.offset+1,length:h.length-2,content:""};else if(h.children.length-1===y){var m=(O=h.children[y-1]).offset+O.length;p={offset:m,length:h.offset+h.length-2-m,content:""}}else p={offset:u.offset,length:h.children[y+1].offset-u.offset,content:""};return withFormatting(t,p,r)}if(void 0!==n){p=void 0,a=""+JSON.stringify(n);if(!r.isArrayInsertion&&h.children.length>l){var w=h.children[l];p={offset:w.offset,length:w.length,content:a}}else if(0===h.children.length||0===l)p={offset:h.offset+1,length:0,content:0===h.children.length?a:a+","};else{var O,A=l>h.children.length?h.children.length:l;p={offset:(O=h.children[A-1]).offset+O.length,length:0,content:","+a}}return withFormatting(t,p,r)}throw new Error("Can not "+(void 0===n?"remove":r.isArrayInsertion?"insert":"modify")+" Array index "+v+" as length is not sufficient")}throw new Error("Can not add "+("number"!=typeof l?"index":"property")+" to parent of type "+h.type)}if(void 0===n)throw new Error("Can not delete in empty document");return withFormatting(t,{offset:f?f.offset:0,length:f?f.length:0,content:JSON.stringify(n)},r)}function withFormatting(t,e,n){if(!n.formattingOptions)return[e];var r=applyEdit(t,e),o=e.offset,i=e.offset+e.content.length;if(0===e.length||0===e.content.length){for(;o>0&&!isEOL(r,o-1);)o--;for(;i<r.length&&!isEOL(r,i);)i++}for(var f=format(r,{offset:o,length:i-o},n.formattingOptions),h=f.length-1;h>=0;h--){var l=f[h];r=applyEdit(r,l),o=Math.min(o,l.offset),i=Math.max(i,l.offset+l.length),i+=l.content.length-l.length}return[{offset:o,length:t.length-(r.length-i)-o,content:r.substring(o,i)}]}export function applyEdit(t,e){return t.substring(0,e.offset)+e.content+t.substring(e.offset+e.length)}export function isWS(t,e){return-1!=="\r\n \t".indexOf(t.charAt(e))}
//# sourceMappingURL=/sm/2c768ed0f744c807e30364d8bc7f96d5abd82a7305f0e55211e164cfbc175661.map