/**
 * Minified by jsDelivr using Terser v5.10.0.
 * Original file: /npm/monaco-editor@0.33.0/esm/vs/editor/browser/viewParts/overviewRuler/decorationsOverviewRuler.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import{createFastDomNode}from"../../../../base/browser/fastDomNode.js";import{Color}from"../../../../base/common/color.js";import{ViewPart}from"../../view/viewPart.js";import{Position}from"../../../common/core/position.js";import{TokenizationRegistry}from"../../../common/languages.js";import{editorCursorForeground,editorOverviewRulerBorder,editorOverviewRulerBackground}from"../../../common/core/editorColorRegistry.js";import{OverviewRulerDecorationsGroup}from"../../../common/viewModel.js";class Settings{constructor(t,e){const o=t.options;this.lineHeight=o.get(59),this.pixelRatio=o.get(129),this.overviewRulerLanes=o.get(74),this.renderBorder=o.get(73);const i=e.getColor(editorOverviewRulerBorder);this.borderColor=i?i.toString():null,this.hideCursor=o.get(52);const s=e.getColor(editorCursorForeground);this.cursorColor=s?s.transparent(.7).toString():null,this.themeType=e.type;const r=o.get(65),n=r.enabled,h=r.side,d=n?e.getColor(editorOverviewRulerBackground)||TokenizationRegistry.getDefaultBackground():null;this.backgroundColor=null===d||"left"===h?null:Color.Format.CSS.formatHex(d);const l=o.get(131).overviewRuler;this.top=l.top,this.right=l.right,this.domWidth=l.width,this.domHeight=l.height,0===this.overviewRulerLanes?(this.canvasWidth=0,this.canvasHeight=0):(this.canvasWidth=this.domWidth*this.pixelRatio|0,this.canvasHeight=this.domHeight*this.pixelRatio|0);const[a,g]=this._initLanes(1,this.canvasWidth,this.overviewRulerLanes);this.x=a,this.w=g}_initLanes(t,e,o){const i=e-t;if(o>=3){const e=Math.floor(i/3),o=Math.floor(i/3),s=i-e-o,r=t+e;return[[0,t,r,t,t+e+s,t,r,t],[0,e,s,e+s,o,e+s+o,s+o,e+s+o]]}if(2===o){const e=Math.floor(i/2),o=i-e;return[[0,t,t,t,t+e,t,t,t],[0,e,e,e,o,e+o,e+o,e+o]]}return[[0,t,t,t,t,t,t,t],[0,i,i,i,i,i,i,i]]}equals(t){return this.lineHeight===t.lineHeight&&this.pixelRatio===t.pixelRatio&&this.overviewRulerLanes===t.overviewRulerLanes&&this.renderBorder===t.renderBorder&&this.borderColor===t.borderColor&&this.hideCursor===t.hideCursor&&this.cursorColor===t.cursorColor&&this.themeType===t.themeType&&this.backgroundColor===t.backgroundColor&&this.top===t.top&&this.right===t.right&&this.domWidth===t.domWidth&&this.domHeight===t.domHeight&&this.canvasWidth===t.canvasWidth&&this.canvasHeight===t.canvasHeight}}export class DecorationsOverviewRuler extends ViewPart{constructor(t){super(t),this._domNode=createFastDomNode(document.createElement("canvas")),this._domNode.setClassName("decorationsOverviewRuler"),this._domNode.setPosition("absolute"),this._domNode.setLayerHinting(!0),this._domNode.setContain("strict"),this._domNode.setAttribute("aria-hidden","true"),this._updateSettings(!1),this._tokensColorTrackerListener=TokenizationRegistry.onDidChange((t=>{t.changedColorMap&&this._updateSettings(!0)})),this._cursorPositions=[]}dispose(){super.dispose(),this._tokensColorTrackerListener.dispose()}_updateSettings(t){const e=new Settings(this._context.configuration,this._context.theme);return(!this._settings||!this._settings.equals(e))&&(this._settings=e,this._domNode.setTop(this._settings.top),this._domNode.setRight(this._settings.right),this._domNode.setWidth(this._settings.domWidth),this._domNode.setHeight(this._settings.domHeight),this._domNode.domNode.width=this._settings.canvasWidth,this._domNode.domNode.height=this._settings.canvasHeight,t&&this._render(),!0)}onConfigurationChanged(t){return this._updateSettings(!1)}onCursorStateChanged(t){this._cursorPositions=[];for(let e=0,o=t.selections.length;e<o;e++)this._cursorPositions[e]=t.selections[e].getPosition();return this._cursorPositions.sort(Position.compare),!0}onDecorationsChanged(t){return!!t.affectsOverviewRuler}onFlushed(t){return!0}onScrollChanged(t){return t.scrollHeightChanged}onZonesChanged(t){return!0}onThemeChanged(t){return this._updateSettings(!1)}getDomNode(){return this._domNode.domNode}prepareRender(t){}render(t){this._render()}_render(){if(0===this._settings.overviewRulerLanes)return this._domNode.setBackgroundColor(this._settings.backgroundColor?this._settings.backgroundColor:""),void this._domNode.setDisplay("none");this._domNode.setDisplay("block");const t=this._settings.canvasWidth,e=this._settings.canvasHeight,o=this._settings.lineHeight,i=this._context.viewLayout,s=e/this._context.viewLayout.getScrollHeight(),r=this._context.viewModel.getAllOverviewRulerDecorations(this._context.theme),n=6*this._settings.pixelRatio|0,h=n/2|0,d=this._domNode.domNode.getContext("2d");null===this._settings.backgroundColor?d.clearRect(0,0,t,e):(d.fillStyle=this._settings.backgroundColor,d.fillRect(0,0,t,e));const l=this._settings.x,a=this._settings.w;r.sort(OverviewRulerDecorationsGroup.cmp);for(const t of r){const r=t.color,g=t.data;d.fillStyle=r;let c=0,u=0,m=0;for(let t=0,r=g.length/3;t<r;t++){const r=g[3*t],_=g[3*t+1],v=g[3*t+2];let p=i.getVerticalOffsetForLineNumber(_)*s|0,C=(i.getVerticalOffsetForLineNumber(v)+o)*s|0;if(C-p<n){let t=(p+C)/2|0;t<h?t=h:t+h>e&&(t=e-h),p=t-h,C=t+h}p>m+1||r!==c?(0!==t&&d.fillRect(l[c],u,a[c],m-u),c=r,u=p,m=C):C>m&&(m=C)}d.fillRect(l[c],u,a[c],m-u)}if(!this._settings.hideCursor&&this._settings.cursorColor){const t=2*this._settings.pixelRatio|0,o=t/2|0,r=this._settings.x[7],n=this._settings.w[7];d.fillStyle=this._settings.cursorColor;let h=-100,l=-100;for(let a=0,g=this._cursorPositions.length;a<g;a++){const g=this._cursorPositions[a];let c=i.getVerticalOffsetForLineNumber(g.lineNumber)*s|0;c<o?c=o:c+o>e&&(c=e-o);const u=c-o,m=u+t;u>l+1?(0!==a&&d.fillRect(r,h,n,l-h),h=u,l=m):m>l&&(l=m)}d.fillRect(r,h,n,l-h)}this._settings.renderBorder&&this._settings.borderColor&&this._settings.overviewRulerLanes>0&&(d.beginPath(),d.lineWidth=1,d.strokeStyle=this._settings.borderColor,d.moveTo(0,0),d.lineTo(0,e),d.stroke(),d.moveTo(0,0),d.lineTo(t,0),d.stroke())}}
//# sourceMappingURL=/sm/fef3403c4ae827cd7dff83b889aa56140abd5e5eacc5d74f1e1bb7deb6ba2803.map