/**
 * Minified by jsDelivr using Terser v5.7.1.
 * Original file: /npm/monaco-editor@0.27.0/esm/vs/editor/browser/core/editorState.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import*as strings from"../../../base/common/strings.js";import{Range}from"../../common/core/range.js";import{CancellationTokenSource}from"../../../base/common/cancellation.js";import{DisposableStore}from"../../../base/common/lifecycle.js";import{EditorKeybindingCancellationTokenSource}from"./keybindingCancellation.js";export class EditorState{constructor(o,t){if(this.flags=t,0!=(1&this.flags)){const t=o.getModel();this.modelVersionId=t?strings.format("{0}#{1}",t.uri.toString(),t.getVersionId()):null}else this.modelVersionId=null;0!=(4&this.flags)?this.position=o.getPosition():this.position=null,0!=(2&this.flags)?this.selection=o.getSelection():this.selection=null,0!=(8&this.flags)?(this.scrollLeft=o.getScrollLeft(),this.scrollTop=o.getScrollTop()):(this.scrollLeft=-1,this.scrollTop=-1)}_equals(o){if(!(o instanceof EditorState))return!1;const t=o;return this.modelVersionId===t.modelVersionId&&(this.scrollLeft===t.scrollLeft&&this.scrollTop===t.scrollTop&&(!(!this.position&&t.position||this.position&&!t.position||this.position&&t.position&&!this.position.equals(t.position))&&!(!this.selection&&t.selection||this.selection&&!t.selection||this.selection&&t.selection&&!this.selection.equalsRange(t.selection))))}validate(o){return this._equals(new EditorState(o,this.flags))}}export class EditorStateCancellationTokenSource extends EditorKeybindingCancellationTokenSource{constructor(o,t,i,e){super(o,e),this._listener=new DisposableStore,4&t&&this._listener.add(o.onDidChangeCursorPosition((o=>{i&&Range.containsPosition(i,o.position)||this.cancel()}))),2&t&&this._listener.add(o.onDidChangeCursorSelection((o=>{i&&Range.containsRange(i,o.selection)||this.cancel()}))),8&t&&this._listener.add(o.onDidScrollChange((o=>this.cancel()))),1&t&&(this._listener.add(o.onDidChangeModel((o=>this.cancel()))),this._listener.add(o.onDidChangeModelContent((o=>this.cancel()))))}dispose(){this._listener.dispose(),super.dispose()}}export class TextModelCancellationTokenSource extends CancellationTokenSource{constructor(o,t){super(t),this._listener=o.onDidChangeContent((()=>this.cancel()))}dispose(){this._listener.dispose(),super.dispose()}}export class StableEditorScrollState{constructor(o,t,i){this._visiblePosition=o,this._visiblePositionScrollDelta=t,this._cursorPosition=i}static capture(o){let t=null,i=0;if(0!==o.getScrollTop()){const e=o.getVisibleRanges();if(e.length>0){t=e[0].getStartPosition();const s=o.getTopForPosition(t.lineNumber,t.column);i=o.getScrollTop()-s}}return new StableEditorScrollState(t,i,o.getPosition())}restore(o){if(this._visiblePosition){const t=o.getTopForPosition(this._visiblePosition.lineNumber,this._visiblePosition.column);o.setScrollTop(t+this._visiblePositionScrollDelta)}}restoreRelativeVerticalPositionOfCursor(o){const t=o.getPosition();if(!this._cursorPosition||!t)return;const i=o.getTopForLineNumber(t.lineNumber)-o.getTopForLineNumber(this._cursorPosition.lineNumber);o.setScrollTop(o.getScrollTop()+i)}}
//# sourceMappingURL=/sm/09da4e2f0a7dd202094eba58024fdf9959c0e44e49c09e9fc0c43ba91304c207.map