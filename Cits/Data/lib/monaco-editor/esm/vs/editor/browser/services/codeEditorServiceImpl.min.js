/**
 * Minified by jsDelivr using Terser v5.7.1.
 * Original file: /npm/monaco-editor@0.27.0/esm/vs/editor/browser/services/codeEditorServiceImpl.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
var __decorate=this&&this.__decorate||function(e,t,o,r){var s,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,o,r);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(n=(i<3?s(n):i>3?s(t,o,n):s(t,o))||n);return i>3&&n&&Object.defineProperty(t,o,n),n},__param=this&&this.__param||function(e,t){return function(o,r){t(o,r,e)}};import*as dom from"../../../base/browser/dom.js";import{DisposableStore}from"../../../base/common/lifecycle.js";import*as strings from"../../../base/common/strings.js";import{URI}from"../../../base/common/uri.js";import{AbstractCodeEditorService}from"./abstractCodeEditorService.js";import{isThemeColor}from"../../common/editorCommon.js";import{OverviewRulerLane}from"../../common/model.js";import{IThemeService}from"../../../platform/theme/common/themeService.js";export class RefCountedStyleSheet{constructor(e,t,o){this._parent=e,this._editorId=t,this._styleSheet=o,this._refCount=0}ref(){this._refCount++}unref(){var e;this._refCount--,0===this._refCount&&(null===(e=this._styleSheet.parentNode)||void 0===e||e.removeChild(this._styleSheet),this._parent._removeEditorStyleSheets(this._editorId))}insertRule(e,t){this._styleSheet.sheet.insertRule(e,t)}removeRulesContainingSelector(e){dom.removeCSSRulesContainingSelector(e,this._styleSheet)}}export class GlobalStyleSheet{constructor(e){this._styleSheet=e}ref(){}unref(){}insertRule(e,t){this._styleSheet.sheet.insertRule(e,t)}removeRulesContainingSelector(e){dom.removeCSSRulesContainingSelector(e,this._styleSheet)}}let CodeEditorServiceImpl=class extends AbstractCodeEditorService{constructor(e,t){super(),this._decorationOptionProviders=new Map,this._editorStyleSheets=new Map,this._globalStyleSheet=e||null,this._themeService=t}_getOrCreateGlobalStyleSheet(){return this._globalStyleSheet||(this._globalStyleSheet=new GlobalStyleSheet(dom.createStyleSheet())),this._globalStyleSheet}_getOrCreateStyleSheet(e){if(!e)return this._getOrCreateGlobalStyleSheet();const t=e.getContainerDomNode();if(!dom.isInShadowDOM(t))return this._getOrCreateGlobalStyleSheet();const o=e.getId();if(!this._editorStyleSheets.has(o)){const e=new RefCountedStyleSheet(this,o,dom.createStyleSheet(t));this._editorStyleSheets.set(o,e)}return this._editorStyleSheets.get(o)}_removeEditorStyleSheets(e){this._editorStyleSheets.delete(e)}registerDecorationType(e,t,o,r,s){let i=this._decorationOptionProviders.get(t);if(!i){const n=this._getOrCreateStyleSheet(s),a={styleSheet:n,key:t,parentTypeKey:r,options:o||Object.create(null)};i=r?new DecorationSubTypeOptionsProvider(this._themeService,n,a):new DecorationTypeOptionsProvider(e,this._themeService,n,a),this._decorationOptionProviders.set(t,i),this._onDecorationTypeRegistered.fire(t)}i.refCount++}removeDecorationType(e){const t=this._decorationOptionProviders.get(e);t&&(t.refCount--,t.refCount<=0&&(this._decorationOptionProviders.delete(e),t.dispose(),this.listCodeEditors().forEach((t=>t.removeDecorations(e)))))}resolveDecorationOptions(e,t){const o=this._decorationOptionProviders.get(e);if(!o)throw new Error("Unknown decoration type key: "+e);return o.getOptions(this,t)}};CodeEditorServiceImpl=__decorate([__param(1,IThemeService)],CodeEditorServiceImpl);export{CodeEditorServiceImpl};export class DecorationSubTypeOptionsProvider{constructor(e,t,o){this._styleSheet=t,this._styleSheet.ref(),this._parentTypeKey=o.parentTypeKey,this.refCount=0,this._beforeContentRules=new DecorationCSSRules(3,o,e),this._afterContentRules=new DecorationCSSRules(4,o,e)}getOptions(e,t){const o=e.resolveDecorationOptions(this._parentTypeKey,!0);return this._beforeContentRules&&(o.beforeContentClassName=this._beforeContentRules.className),this._afterContentRules&&(o.afterContentClassName=this._afterContentRules.className),o}dispose(){this._beforeContentRules&&(this._beforeContentRules.dispose(),this._beforeContentRules=null),this._afterContentRules&&(this._afterContentRules.dispose(),this._afterContentRules=null),this._styleSheet.unref()}}export class DecorationTypeOptionsProvider{constructor(e,t,o,r){this._disposables=new DisposableStore,this.description=e,this._styleSheet=o,this._styleSheet.ref(),this.refCount=0;const s=e=>{const o=new DecorationCSSRules(e,r,t);if(this._disposables.add(o),o.hasContent)return o.className},i=e=>{const o=new DecorationCSSRules(e,r,t);return this._disposables.add(o),o.hasContent?{className:o.className,hasLetterSpacing:o.hasLetterSpacing}:null};this.className=s(0);const n=i(1);if(n&&(this.inlineClassName=n.className,this.inlineClassNameAffectsLetterSpacing=n.hasLetterSpacing),this.beforeContentClassName=s(3),this.afterContentClassName=s(4),r.options.beforeInjectedText&&r.options.beforeInjectedText.contentText){const e=i(5);this.beforeInjectedText={content:r.options.beforeInjectedText.contentText,inlineClassName:null==e?void 0:e.className,inlineClassNameAffectsLetterSpacing:(null==e?void 0:e.hasLetterSpacing)||r.options.beforeInjectedText.affectsLetterSpacing}}if(r.options.afterInjectedText&&r.options.afterInjectedText.contentText){const e=i(6);this.afterInjectedText={content:r.options.afterInjectedText.contentText,inlineClassName:null==e?void 0:e.className,inlineClassNameAffectsLetterSpacing:(null==e?void 0:e.hasLetterSpacing)||r.options.afterInjectedText.affectsLetterSpacing}}this.glyphMarginClassName=s(2);const a=r.options;this.isWholeLine=Boolean(a.isWholeLine),this.stickiness=a.rangeBehavior;const l=a.light&&a.light.overviewRulerColor||a.overviewRulerColor,h=a.dark&&a.dark.overviewRulerColor||a.overviewRulerColor;void 0===l&&void 0===h||(this.overviewRuler={color:l||h,darkColor:h||l,position:a.overviewRulerLane||OverviewRulerLane.Center})}getOptions(e,t){return t?{description:this.description,inlineClassName:this.inlineClassName,beforeContentClassName:this.beforeContentClassName,afterContentClassName:this.afterContentClassName,className:this.className,glyphMarginClassName:this.glyphMarginClassName,isWholeLine:this.isWholeLine,overviewRuler:this.overviewRuler,stickiness:this.stickiness,before:this.beforeInjectedText}:this}dispose(){this._disposables.dispose(),this._styleSheet.unref()}}export const _CSS_MAP={color:"color:{0} !important;",opacity:"opacity:{0};",backgroundColor:"background-color:{0};",outline:"outline:{0};",outlineColor:"outline-color:{0};",outlineStyle:"outline-style:{0};",outlineWidth:"outline-width:{0};",border:"border:{0};",borderColor:"border-color:{0};",borderRadius:"border-radius:{0};",borderSpacing:"border-spacing:{0};",borderStyle:"border-style:{0};",borderWidth:"border-width:{0};",fontStyle:"font-style:{0};",fontWeight:"font-weight:{0};",fontSize:"font-size:{0};",fontFamily:"font-family:{0};",textDecoration:"text-decoration:{0};",cursor:"cursor:{0};",letterSpacing:"letter-spacing:{0};",gutterIconPath:"background:{0} center center no-repeat;",gutterIconSize:"background-size:{0};",contentText:"content:'{0}';",contentIconPath:"content:{0};",margin:"margin:{0};",padding:"padding:{0};",width:"width:{0};",height:"height:{0};"};class DecorationCSSRules{constructor(e,t,o){this._theme=o.getColorTheme(),this._ruleType=e,this._providerArgs=t,this._usesThemeColors=!1,this._hasContent=!1,this._hasLetterSpacing=!1;let r=CSSNameHelper.getClassName(this._providerArgs.key,e);this._providerArgs.parentTypeKey&&(r=r+" "+CSSNameHelper.getClassName(this._providerArgs.parentTypeKey,e)),this._className=r,this._unThemedSelector=CSSNameHelper.getSelector(this._providerArgs.key,this._providerArgs.parentTypeKey,e),this._buildCSS(),this._usesThemeColors?this._themeListener=o.onDidColorThemeChange((e=>{this._theme=o.getColorTheme(),this._removeCSS(),this._buildCSS()})):this._themeListener=null}dispose(){this._hasContent&&(this._removeCSS(),this._hasContent=!1),this._themeListener&&(this._themeListener.dispose(),this._themeListener=null)}get hasContent(){return this._hasContent}get hasLetterSpacing(){return this._hasLetterSpacing}get className(){return this._className}_buildCSS(){const e=this._providerArgs.options;let t,o,r;switch(this._ruleType){case 0:t=this.getCSSTextForModelDecorationClassName(e),o=this.getCSSTextForModelDecorationClassName(e.light),r=this.getCSSTextForModelDecorationClassName(e.dark);break;case 1:t=this.getCSSTextForModelDecorationInlineClassName(e),o=this.getCSSTextForModelDecorationInlineClassName(e.light),r=this.getCSSTextForModelDecorationInlineClassName(e.dark);break;case 2:t=this.getCSSTextForModelDecorationGlyphMarginClassName(e),o=this.getCSSTextForModelDecorationGlyphMarginClassName(e.light),r=this.getCSSTextForModelDecorationGlyphMarginClassName(e.dark);break;case 3:t=this.getCSSTextForModelDecorationContentClassName(e.before),o=this.getCSSTextForModelDecorationContentClassName(e.light&&e.light.before),r=this.getCSSTextForModelDecorationContentClassName(e.dark&&e.dark.before);break;case 4:t=this.getCSSTextForModelDecorationContentClassName(e.after),o=this.getCSSTextForModelDecorationContentClassName(e.light&&e.light.after),r=this.getCSSTextForModelDecorationContentClassName(e.dark&&e.dark.after);break;case 5:t=this.getCSSTextForModelDecorationContentClassName(e.beforeInjectedText),o=this.getCSSTextForModelDecorationContentClassName(e.light&&e.light.beforeInjectedText),r=this.getCSSTextForModelDecorationContentClassName(e.dark&&e.dark.beforeInjectedText);break;case 6:t=this.getCSSTextForModelDecorationContentClassName(e.afterInjectedText),o=this.getCSSTextForModelDecorationContentClassName(e.light&&e.light.afterInjectedText),r=this.getCSSTextForModelDecorationContentClassName(e.dark&&e.dark.afterInjectedText);break;default:throw new Error("Unknown rule type: "+this._ruleType)}const s=this._providerArgs.styleSheet;let i=!1;t.length>0&&(s.insertRule(`${this._unThemedSelector} {${t}}`,0),i=!0),o.length>0&&(s.insertRule(`.vs${this._unThemedSelector} {${o}}`,0),i=!0),r.length>0&&(s.insertRule(`.vs-dark${this._unThemedSelector}, .hc-black${this._unThemedSelector} {${r}}`,0),i=!0),this._hasContent=i}_removeCSS(){this._providerArgs.styleSheet.removeRulesContainingSelector(this._unThemedSelector)}getCSSTextForModelDecorationClassName(e){if(!e)return"";const t=[];return this.collectCSSText(e,["backgroundColor"],t),this.collectCSSText(e,["outline","outlineColor","outlineStyle","outlineWidth"],t),this.collectBorderSettingsCSSText(e,t),t.join("")}getCSSTextForModelDecorationInlineClassName(e){if(!e)return"";const t=[];return this.collectCSSText(e,["fontStyle","fontWeight","textDecoration","cursor","color","opacity","letterSpacing"],t),e.letterSpacing&&(this._hasLetterSpacing=!0),t.join("")}getCSSTextForModelDecorationContentClassName(e){if(!e)return"";const t=[];if(void 0!==e){if(this.collectBorderSettingsCSSText(e,t),void 0!==e.contentIconPath&&t.push(strings.format(_CSS_MAP.contentIconPath,dom.asCSSUrl(URI.revive(e.contentIconPath)))),"string"==typeof e.contentText){const o=e.contentText.match(/^.*$/m)[0].replace(/['\\]/g,"\\$&");t.push(strings.format(_CSS_MAP.contentText,o))}this.collectCSSText(e,["fontStyle","fontWeight","fontSize","fontFamily","textDecoration","color","opacity","backgroundColor","margin","padding"],t),this.collectCSSText(e,["width","height"],t)&&t.push("display:inline-block;")}return t.join("")}getCSSTextForModelDecorationGlyphMarginClassName(e){if(!e)return"";const t=[];return void 0!==e.gutterIconPath&&(t.push(strings.format(_CSS_MAP.gutterIconPath,dom.asCSSUrl(URI.revive(e.gutterIconPath)))),void 0!==e.gutterIconSize&&t.push(strings.format(_CSS_MAP.gutterIconSize,e.gutterIconSize))),t.join("")}collectBorderSettingsCSSText(e,t){return!!this.collectCSSText(e,["border","borderColor","borderRadius","borderSpacing","borderStyle","borderWidth"],t)&&(t.push(strings.format("box-sizing: border-box;")),!0)}collectCSSText(e,t,o){const r=o.length;for(let r of t){const t=this.resolveValue(e[r]);"string"==typeof t&&o.push(strings.format(_CSS_MAP[r],t))}return o.length!==r}resolveValue(e){if(isThemeColor(e)){this._usesThemeColors=!0;const t=this._theme.getColor(e.id);return t?t.toString():"transparent"}return e}}class CSSNameHelper{static getClassName(e,t){return"ced-"+e+"-"+t}static getSelector(e,t,o){let r=".monaco-editor ."+this.getClassName(e,o);return t&&(r=r+"."+this.getClassName(t,o)),3===o?r+="::before":4===o&&(r+="::after"),r}}
//# sourceMappingURL=/sm/cd4cda5d631e454d4d08362e3a562cc733bd659202eb566d266362829fc2afae.map