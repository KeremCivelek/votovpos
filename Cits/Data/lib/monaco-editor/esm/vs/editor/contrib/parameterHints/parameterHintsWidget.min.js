/**
 * Minified by jsDelivr using Terser v5.7.1.
 * Original file: /npm/monaco-editor@0.27.0/esm/vs/editor/contrib/parameterHints/parameterHintsWidget.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
var __decorate=this&&this.__decorate||function(e,t,o,r){var s,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,o,r);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(n=(i<3?s(n):i>3?s(t,o,n):s(t,o))||n);return i>3&&n&&Object.defineProperty(t,o,n),n},__param=this&&this.__param||function(e,t){return function(o,r){t(o,r,e)}};import*as dom from"../../../base/browser/dom.js";import*as aria from"../../../base/browser/ui/aria/aria.js";import{DomScrollableElement}from"../../../base/browser/ui/scrollbar/scrollableElement.js";import{Event}from"../../../base/common/event.js";import{Disposable,DisposableStore}from"../../../base/common/lifecycle.js";import"./parameterHints.css";import{IModeService}from"../../common/services/modeService.js";import{MarkdownRenderer}from"../../browser/core/markdownRenderer.js";import{Context}from"./provideSignatureHelp.js";import*as nls from"../../../nls.js";import{IContextKeyService}from"../../../platform/contextkey/common/contextkey.js";import{IOpenerService}from"../../../platform/opener/common/opener.js";import{editorHoverBackground,editorHoverBorder,textCodeBlockBackground,textLinkForeground,editorHoverForeground}from"../../../platform/theme/common/colorRegistry.js";import{registerThemingParticipant,ThemeIcon}from"../../../platform/theme/common/themeService.js";import{ParameterHintsModel}from"./parameterHintsModel.js";import{escapeRegExpCharacters}from"../../../base/common/strings.js";import{Codicon}from"../../../base/common/codicons.js";import{assertIsDefined}from"../../../base/common/types.js";import{ColorScheme}from"../../../platform/theme/common/theme.js";import{registerIcon}from"../../../platform/theme/common/iconRegistry.js";const $=dom.$,parameterHintsNextIcon=registerIcon("parameter-hints-next",Codicon.chevronDown,nls.localize("parameterHintsNextIcon","Icon for show next parameter hint.")),parameterHintsPreviousIcon=registerIcon("parameter-hints-previous",Codicon.chevronUp,nls.localize("parameterHintsPreviousIcon","Icon for show previous parameter hint."));let ParameterHintsWidget=class e extends Disposable{constructor(e,t,o,r){super(),this.editor=e,this.renderDisposeables=this._register(new DisposableStore),this.visible=!1,this.announcedLabel=null,this.allowEditorOverflow=!0,this.markdownRenderer=this._register(new MarkdownRenderer({editor:e},r,o)),this.model=this._register(new ParameterHintsModel(e)),this.keyVisible=Context.Visible.bindTo(t),this.keyMultipleSignatures=Context.MultipleSignatures.bindTo(t),this._register(this.model.onChangedHints((e=>{e?(this.show(),this.render(e)):this.hide()})))}createParameterHintDOMNodes(){const e=$(".editor-widget.parameter-hints-widget"),t=dom.append(e,$(".phwrapper"));t.tabIndex=-1;const o=dom.append(t,$(".controls")),r=dom.append(o,$(".button"+ThemeIcon.asCSSSelector(parameterHintsPreviousIcon))),s=dom.append(o,$(".overloads")),i=dom.append(o,$(".button"+ThemeIcon.asCSSSelector(parameterHintsNextIcon)));this._register(dom.addDisposableListener(r,"click",(e=>{dom.EventHelper.stop(e),this.previous()}))),this._register(dom.addDisposableListener(i,"click",(e=>{dom.EventHelper.stop(e),this.next()})));const n=$(".body"),a=new DomScrollableElement(n,{});this._register(a),t.appendChild(a.getDomNode());const d=dom.append(n,$(".signature")),m=dom.append(n,$(".docs"));e.style.userSelect="text",this.domNodes={element:e,signature:d,overloads:s,docs:m,scrollbar:a},this.editor.addContentWidget(this),this.hide(),this._register(this.editor.onDidChangeCursorSelection((e=>{this.visible&&this.editor.layoutContentWidget(this)})));const l=()=>{if(!this.domNodes)return;const e=this.editor.getOption(41);this.domNodes.element.style.fontSize=`${e.fontSize}px`};l(),this._register(Event.chain(this.editor.onDidChangeConfiguration.bind(this.editor)).filter((e=>e.hasChanged(41))).on(l,null)),this._register(this.editor.onDidLayoutChange((e=>this.updateMaxHeight()))),this.updateMaxHeight()}show(){this.visible||(this.domNodes||this.createParameterHintDOMNodes(),this.keyVisible.set(!0),this.visible=!0,setTimeout((()=>{this.domNodes&&this.domNodes.element.classList.add("visible")}),100),this.editor.layoutContentWidget(this))}hide(){this.renderDisposeables.clear(),this.visible&&(this.keyVisible.reset(),this.visible=!1,this.announcedLabel=null,this.domNodes&&this.domNodes.element.classList.remove("visible"),this.editor.layoutContentWidget(this))}getPosition(){return this.visible?{position:this.editor.getPosition(),preference:[1,2]}:null}render(e){var t;if(this.renderDisposeables.clear(),!this.domNodes)return;const o=e.signatures.length>1;this.domNodes.element.classList.toggle("multiple",o),this.keyMultipleSignatures.set(o),this.domNodes.signature.innerText="",this.domNodes.docs.innerText="";const r=e.signatures[e.activeSignature];if(!r)return;const s=dom.append(this.domNodes.signature,$(".code")),i=this.editor.getOption(41);s.style.fontSize=`${i.fontSize}px`,s.style.fontFamily=i.fontFamily;const n=r.parameters.length>0,a=null!==(t=r.activeParameter)&&void 0!==t?t:e.activeParameter;if(n)this.renderParameters(s,r,a);else{dom.append(s,$("span")).textContent=r.label}const d=r.parameters[a];if(null==d?void 0:d.documentation){const e=$("span.documentation");if("string"==typeof d.documentation)e.textContent=d.documentation;else{const t=this.renderMarkdownDocs(d.documentation);e.appendChild(t.element)}dom.append(this.domNodes.docs,$("p",{},e))}if(void 0===r.documentation);else if("string"==typeof r.documentation)dom.append(this.domNodes.docs,$("p",{},r.documentation));else{const e=this.renderMarkdownDocs(r.documentation);dom.append(this.domNodes.docs,e.element)}const m=this.hasDocs(r,d);if(this.domNodes.signature.classList.toggle("has-docs",m),this.domNodes.docs.classList.toggle("empty",!m),this.domNodes.overloads.textContent=String(e.activeSignature+1).padStart(e.signatures.length.toString().length,"0")+"/"+e.signatures.length,d){const e=this.getParameterLabel(r,a);this.announcedLabel!==e&&(aria.alert(nls.localize("hint","{0}, hint",e)),this.announcedLabel=e)}this.editor.layoutContentWidget(this),this.domNodes.scrollbar.scanDomNode()}renderMarkdownDocs(e){const t=this.renderDisposeables.add(this.markdownRenderer.render(e,{asyncRenderCallback:()=>{var e;null===(e=this.domNodes)||void 0===e||e.scrollbar.scanDomNode()}}));return t.element.classList.add("markdown-docs"),t}hasDocs(e,t){return!!(t&&"string"==typeof t.documentation&&assertIsDefined(t.documentation).length>0)||(!!(t&&"object"==typeof t.documentation&&assertIsDefined(t.documentation).value.length>0)||(!!(e.documentation&&"string"==typeof e.documentation&&assertIsDefined(e.documentation).length>0)||!!(e.documentation&&"object"==typeof e.documentation&&assertIsDefined(e.documentation.value).length>0)))}renderParameters(e,t,o){const[r,s]=this.getParameterLabelOffsets(t,o),i=document.createElement("span");i.textContent=t.label.substring(0,r);const n=document.createElement("span");n.textContent=t.label.substring(r,s),n.className="parameter active";const a=document.createElement("span");a.textContent=t.label.substring(s),dom.append(e,i,n,a)}getParameterLabel(e,t){const o=e.parameters[t];return Array.isArray(o.label)?e.label.substring(o.label[0],o.label[1]):o.label}getParameterLabelOffsets(e,t){const o=e.parameters[t];if(o){if(Array.isArray(o.label))return o.label;if(o.label.length){const t=new RegExp(`(\\W|^)${escapeRegExpCharacters(o.label)}(?=\\W|$)`,"g");t.test(e.label);const r=t.lastIndex-o.label.length;return r>=0?[r,t.lastIndex]:[0,0]}return[0,0]}return[0,0]}next(){this.editor.focus(),this.model.next()}previous(){this.editor.focus(),this.model.previous()}cancel(){this.model.cancel()}getDomNode(){return this.domNodes||this.createParameterHintDOMNodes(),this.domNodes.element}getId(){return e.ID}trigger(e){this.model.trigger(e,0)}updateMaxHeight(){if(!this.domNodes)return;const e=`${Math.max(this.editor.getLayoutInfo().height/4,250)}px`;this.domNodes.element.style.maxHeight=e;const t=this.domNodes.element.getElementsByClassName("phwrapper");t.length&&(t[0].style.maxHeight=e)}};ParameterHintsWidget.ID="editor.widget.parameterHintsWidget",ParameterHintsWidget=__decorate([__param(1,IContextKeyService),__param(2,IOpenerService),__param(3,IModeService)],ParameterHintsWidget);export{ParameterHintsWidget};registerThemingParticipant(((e,t)=>{const o=e.getColor(editorHoverBorder);if(o){const r=e.type===ColorScheme.HIGH_CONTRAST?2:1;t.addRule(`.monaco-editor .parameter-hints-widget { border: ${r}px solid ${o}; }`),t.addRule(`.monaco-editor .parameter-hints-widget.multiple .body { border-left: 1px solid ${o.transparent(.5)}; }`),t.addRule(`.monaco-editor .parameter-hints-widget .signature.has-docs { border-bottom: 1px solid ${o.transparent(.5)}; }`)}const r=e.getColor(editorHoverBackground);r&&t.addRule(`.monaco-editor .parameter-hints-widget { background-color: ${r}; }`);const s=e.getColor(textLinkForeground);s&&t.addRule(`.monaco-editor .parameter-hints-widget a { color: ${s}; }`);const i=e.getColor(editorHoverForeground);i&&t.addRule(`.monaco-editor .parameter-hints-widget { color: ${i}; }`);const n=e.getColor(textCodeBlockBackground);n&&t.addRule(`.monaco-editor .parameter-hints-widget code { background-color: ${n}; }`)}));
//# sourceMappingURL=/sm/89259efa0e753afe8fe1ea21fea0c9da65ba2a96c7461be2b25423ec94176735.map