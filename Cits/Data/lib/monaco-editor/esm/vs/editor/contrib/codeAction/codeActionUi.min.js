/**
 * Minified by jsDelivr using Terser v5.7.1.
 * Original file: /npm/monaco-editor@0.27.0/esm/vs/editor/contrib/codeAction/codeActionUi.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
var _CodeActionUi_disposed,__decorate=this&&this.__decorate||function(t,e,i,o){var n,s=arguments.length,r=s<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(r=(s<3?n(r):s>3?n(e,i,r):n(e,i))||r);return s>3&&r&&Object.defineProperty(e,i,r),r},__param=this&&this.__param||function(t,e){return function(i,o){e(i,o,t)}},__awaiter=this&&this.__awaiter||function(t,e,i,o){return new(i||(i=Promise))((function(n,s){function r(t){try{l(o.next(t))}catch(t){s(t)}}function a(t){try{l(o.throw(t))}catch(t){s(t)}}function l(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(r,a)}l((o=o.apply(t,e||[])).next())}))},__classPrivateFieldSet=this&&this.__classPrivateFieldSet||function(t,e,i,o,n){if("m"===o)throw new TypeError("Private method is not writable");if("a"===o&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===o?n.call(t,i):n?n.value=i:e.set(t,i),i},__classPrivateFieldGet=this&&this.__classPrivateFieldGet||function(t,e,i,o){if("a"===i&&!o)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!o:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?o:"a"===i?o.call(t):o?o.value:e.get(t)};import{onUnexpectedError}from"../../../base/common/errors.js";import{Lazy}from"../../../base/common/lazy.js";import{Disposable,MutableDisposable}from"../../../base/common/lifecycle.js";import{MessageController}from"../message/messageController.js";import{IInstantiationService}from"../../../platform/instantiation/common/instantiation.js";import{CodeActionMenu}from"./codeActionMenu.js";import{LightBulbWidget}from"./lightBulbWidget.js";let CodeActionUi=class extends Disposable{constructor(t,e,i,o,n){super(),this._editor=t,this.delegate=o,this._activeCodeActions=this._register(new MutableDisposable),_CodeActionUi_disposed.set(this,!1),this._codeActionWidget=new Lazy((()=>this._register(n.createInstance(CodeActionMenu,this._editor,{onSelectCodeAction:t=>__awaiter(this,void 0,void 0,(function*(){this.delegate.applyCodeAction(t,!0)}))})))),this._lightBulbWidget=new Lazy((()=>{const t=this._register(n.createInstance(LightBulbWidget,this._editor,e,i));return this._register(t.onClick((t=>this.showCodeActionList(t.trigger,t.actions,t,{includeDisabledActions:!1})))),t}))}dispose(){__classPrivateFieldSet(this,_CodeActionUi_disposed,!0,"f"),super.dispose()}update(t){var e,i,o;return __awaiter(this,void 0,void 0,(function*(){if(1!==t.type)return void(null===(e=this._lightBulbWidget.rawValue)||void 0===e||e.hide());let n;try{n=yield t.actions}catch(t){return void onUnexpectedError(t)}if(!__classPrivateFieldGet(this,_CodeActionUi_disposed,"f"))if(this._lightBulbWidget.getValue().update(n,t.trigger,t.position),1===t.trigger.type){if(null===(i=t.trigger.filter)||void 0===i?void 0:i.include){const e=this.tryGetValidActionToApply(t.trigger,n);if(e){try{yield this.delegate.applyCodeAction(e,!1)}finally{n.dispose()}return}if(t.trigger.context){const e=this.getInvalidActionThatWouldHaveBeenApplied(t.trigger,n);if(e&&e.action.disabled)return MessageController.get(this._editor).showMessage(e.action.disabled,t.trigger.context.position),void n.dispose()}}const e=!!(null===(o=t.trigger.filter)||void 0===o?void 0:o.include);if(t.trigger.context&&(!n.allActions.length||!e&&!n.validActions.length))return MessageController.get(this._editor).showMessage(t.trigger.context.notAvailableMessage,t.trigger.context.position),this._activeCodeActions.value=n,void n.dispose();this._activeCodeActions.value=n,this._codeActionWidget.getValue().show(t.trigger,n,t.position,{includeDisabledActions:e})}else this._codeActionWidget.getValue().isVisible?n.dispose():this._activeCodeActions.value=n}))}getInvalidActionThatWouldHaveBeenApplied(t,e){if(e.allActions.length)return"first"===t.autoApply&&0===e.validActions.length||"ifSingle"===t.autoApply&&1===e.allActions.length?e.allActions.find((({action:t})=>t.disabled)):void 0}tryGetValidActionToApply(t,e){if(e.validActions.length)return"first"===t.autoApply&&e.validActions.length>0||"ifSingle"===t.autoApply&&1===e.validActions.length?e.validActions[0]:void 0}showCodeActionList(t,e,i,o){return __awaiter(this,void 0,void 0,(function*(){this._codeActionWidget.getValue().show(t,e,i,o)}))}};_CodeActionUi_disposed=new WeakMap,CodeActionUi=__decorate([__param(4,IInstantiationService)],CodeActionUi);export{CodeActionUi};
//# sourceMappingURL=/sm/6f545d34f1a3e332ae896abcadee101162e7f71f65d8744a70108fe1e239a786.map