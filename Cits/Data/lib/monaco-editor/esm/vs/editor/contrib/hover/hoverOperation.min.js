/**
 * Minified by jsDelivr using Terser v5.7.1.
 * Original file: /npm/monaco-editor@0.27.0/esm/vs/editor/contrib/hover/hoverOperation.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import{RunOnceScheduler,createCancelablePromise}from"../../../base/common/async.js";import{onUnexpectedError}from"../../../base/common/errors.js";export class HoverOperation{constructor(t,e,s,i,o){this._computer=t,this._state=0,this._hoverTime=o,this._firstWaitScheduler=new RunOnceScheduler((()=>this._triggerAsyncComputation()),0),this._secondWaitScheduler=new RunOnceScheduler((()=>this._triggerSyncComputation()),0),this._loadingMessageScheduler=new RunOnceScheduler((()=>this._showLoadingMessage()),0),this._asyncComputationPromise=null,this._asyncComputationPromiseDone=!1,this._completeCallback=e,this._errorCallback=s,this._progressCallback=i}setHoverTime(t){this._hoverTime=t}_firstWaitTime(){return this._hoverTime/2}_secondWaitTime(){return this._hoverTime/2}_loadingMessageTime(){return 3*this._hoverTime}_triggerAsyncComputation(){this._state=2,this._secondWaitScheduler.schedule(this._secondWaitTime()),this._computer.computeAsync?(this._asyncComputationPromiseDone=!1,this._asyncComputationPromise=createCancelablePromise((t=>this._computer.computeAsync(t))),this._asyncComputationPromise.then((t=>{this._asyncComputationPromiseDone=!0,this._withAsyncResult(t)}),(t=>this._onError(t)))):this._asyncComputationPromiseDone=!0}_triggerSyncComputation(){this._computer.computeSync&&this._computer.onResult(this._computer.computeSync(),!0),this._asyncComputationPromiseDone?(this._state=0,this._onComplete(this._computer.getResult())):(this._state=3,this._onProgress(this._computer.getResult()))}_showLoadingMessage(){3===this._state&&this._onProgress(this._computer.getResultWithLoadingMessage())}_withAsyncResult(t){t&&this._computer.onResult(t,!1),3===this._state&&(this._state=0,this._onComplete(this._computer.getResult()))}_onComplete(t){this._completeCallback(t)}_onError(t){this._errorCallback?this._errorCallback(t):onUnexpectedError(t)}_onProgress(t){this._progressCallback(t)}start(t){if(0===t)0===this._state&&(this._state=1,this._firstWaitScheduler.schedule(this._firstWaitTime()),this._loadingMessageScheduler.schedule(this._loadingMessageTime()));else switch(this._state){case 0:this._triggerAsyncComputation(),this._secondWaitScheduler.cancel(),this._triggerSyncComputation();break;case 2:this._secondWaitScheduler.cancel(),this._triggerSyncComputation()}}cancel(){this._loadingMessageScheduler.cancel(),1===this._state&&this._firstWaitScheduler.cancel(),2===this._state&&(this._secondWaitScheduler.cancel(),this._asyncComputationPromise&&(this._asyncComputationPromise.cancel(),this._asyncComputationPromise=null)),3===this._state&&this._asyncComputationPromise&&(this._asyncComputationPromise.cancel(),this._asyncComputationPromise=null),this._state=0}}
//# sourceMappingURL=/sm/b2fb3f408497cdf85f44215f14b17514428bc8b80deeea970e0fa2b6e31e2998.map