/**
 * Minified by jsDelivr using Terser v5.7.1.
 * Original file: /npm/monaco-editor@0.27.0/esm/vs/editor/contrib/hover/colorHoverParticipant.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
var __decorate=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(i<3?n(a):i>3?n(t,o,a):n(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},__param=this&&this.__param||function(e,t){return function(o,r){t(o,r,e)}},__awaiter=this&&this.__awaiter||function(e,t,o,r){return new(o||(o=Promise))((function(n,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))};import{Disposable,DisposableStore}from"../../../base/common/lifecycle.js";import{Range}from"../../common/core/range.js";import{CancellationToken}from"../../../base/common/cancellation.js";import{getColorPresentations}from"../colorPicker/color.js";import{ColorDetector}from"../colorPicker/colorDetector.js";import{Color,RGBA}from"../../../base/common/color.js";import{ColorPickerModel}from"../colorPicker/colorPickerModel.js";import{ColorPickerWidget}from"../colorPicker/colorPickerWidget.js";import{IThemeService}from"../../../platform/theme/common/themeService.js";export class ColorHover{constructor(e,t,o,r){this.owner=e,this.range=t,this.model=o,this.provider=r,this.forceShowAtRange=!0}isValidForHoverAnchor(e){return 1===e.type&&this.range.startColumn<=e.range.startColumn&&this.range.endColumn>=e.range.endColumn}}let ColorHoverParticipant=class{constructor(e,t,o){this._editor=e,this._hover=t,this._themeService=o}computeSync(e,t){return[]}computeAsync(e,t,o){return __awaiter(this,void 0,void 0,(function*(){if(!this._editor.hasModel())return[];const e=ColorDetector.get(this._editor);for(const o of t){const t=e.getColorData(o.range.getStartPosition());if(t){return[yield this._createColorHover(this._editor.getModel(),t.colorInfo,t.provider)]}}return[]}))}_createColorHover(e,t,o){return __awaiter(this,void 0,void 0,(function*(){const r=e.getValueInRange(t.range),{red:n,green:i,blue:a,alpha:s}=t.color,l=new RGBA(Math.round(255*n),Math.round(255*i),Math.round(255*a),s),c=new Color(l),d=yield getColorPresentations(e,t,o,CancellationToken.None),h=new ColorPickerModel(c,[],0);return h.colorPresentations=d||[],h.guessColorPresentation(c,r),new ColorHover(this,Range.lift(t.range),h,o)}))}renderHoverParts(e,t,o){if(0===e.length||!this._editor.hasModel())return Disposable.None;const r=new DisposableStore,n=e[0],i=this._editor.getModel(),a=n.model,s=r.add(new ColorPickerWidget(t,a,this._editor.getOption(127),this._themeService));let l=new Range(n.range.startLineNumber,n.range.startColumn,n.range.endLineNumber,n.range.endColumn);const c=()=>{let e,t;if(a.presentation.textEdit){e=[a.presentation.textEdit],t=new Range(a.presentation.textEdit.range.startLineNumber,a.presentation.textEdit.range.startColumn,a.presentation.textEdit.range.endLineNumber,a.presentation.textEdit.range.endColumn);const o=this._editor.getModel()._setTrackedRange(null,t,3);this._editor.pushUndoStop(),this._editor.executeEdits("colorpicker",e),t=this._editor.getModel()._getTrackedRange(o)||t}else e=[{identifier:null,range:l,text:a.presentation.label,forceMoveMarkers:!1}],t=l.setEndPosition(l.endLineNumber,l.startColumn+a.presentation.label.length),this._editor.pushUndoStop(),this._editor.executeEdits("colorpicker",e);a.presentation.additionalTextEdits&&(e=[...a.presentation.additionalTextEdits],this._editor.executeEdits("colorpicker",e),this._hover.hide()),this._editor.pushUndoStop(),l=t},d=e=>getColorPresentations(i,{range:l,color:{red:e.rgba.r/255,green:e.rgba.g/255,blue:e.rgba.b/255,alpha:e.rgba.a}},n.provider,CancellationToken.None).then((e=>{a.colorPresentations=e||[]}));return r.add(a.onColorFlushed((e=>{d(e).then(c)}))),r.add(a.onDidChangeColor(d)),this._hover.setColorPicker(s),r}};ColorHoverParticipant=__decorate([__param(2,IThemeService)],ColorHoverParticipant);export{ColorHoverParticipant};
//# sourceMappingURL=/sm/8533ff68c07153ba36830f910df496711efd139bc6932f36f966796788fdb743.map