/**
 * Minified by jsDelivr using Terser v5.7.1.
 * Original file: /npm/monaco-editor@0.27.0/esm/vs/editor/contrib/codelens/codelens.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
var __awaiter=this&&this.__awaiter||function(e,o,s,r){return new(s||(s=Promise))((function(n,t){function i(e){try{a(r.next(e))}catch(e){t(e)}}function m(e){try{a(r.throw(e))}catch(e){t(e)}}function a(e){var o;e.done?n(e.value):(o=e.value,o instanceof s?o:new s((function(e){e(o)}))).then(i,m)}a((r=r.apply(e,o||[])).next())}))};import{CancellationToken}from"../../../base/common/cancellation.js";import{illegalArgument,onUnexpectedExternalError}from"../../../base/common/errors.js";import{URI}from"../../../base/common/uri.js";import{CodeLensProviderRegistry}from"../../common/modes.js";import{IModelService}from"../../common/services/modelService.js";import{DisposableStore}from"../../../base/common/lifecycle.js";import{CommandsRegistry}from"../../../platform/commands/common/commands.js";import{assertType}from"../../../base/common/types.js";export class CodeLensModel{constructor(){this.lenses=[],this._disposables=new DisposableStore}dispose(){this._disposables.dispose()}add(e,o){this._disposables.add(e);for(const s of e.lenses)this.lenses.push({symbol:s,provider:o})}}export function getCodeLensModel(e,o){return __awaiter(this,void 0,void 0,(function*(){const s=CodeLensProviderRegistry.ordered(e),r=new Map,n=new CodeLensModel,t=s.map(((s,t)=>__awaiter(this,void 0,void 0,(function*(){r.set(s,t);try{const r=yield Promise.resolve(s.provideCodeLenses(e,o));r&&n.add(r,s)}catch(e){onUnexpectedExternalError(e)}}))));return yield Promise.all(t),n.lenses=n.lenses.sort(((e,o)=>e.symbol.range.startLineNumber<o.symbol.range.startLineNumber?-1:e.symbol.range.startLineNumber>o.symbol.range.startLineNumber?1:r.get(e.provider)<r.get(o.provider)?-1:r.get(e.provider)>r.get(o.provider)?1:e.symbol.range.startColumn<o.symbol.range.startColumn?-1:e.symbol.range.startColumn>o.symbol.range.startColumn?1:0)),n}))}CommandsRegistry.registerCommand("_executeCodeLensProvider",(function(e,...o){let[s,r]=o;assertType(URI.isUri(s)),assertType("number"==typeof r||!r);const n=e.get(IModelService).getModel(s);if(!n)throw illegalArgument();const t=[],i=new DisposableStore;return getCodeLensModel(n,CancellationToken.None).then((e=>{i.add(e);let o=[];for(const s of e.lenses)null==r||Boolean(s.symbol.command)?t.push(s.symbol):r-- >0&&s.provider.resolveCodeLens&&o.push(Promise.resolve(s.provider.resolveCodeLens(n,s.symbol,CancellationToken.None)).then((e=>t.push(e||s.symbol))));return Promise.all(o)})).then((()=>t)).finally((()=>{setTimeout((()=>i.dispose()),100)}))}));
//# sourceMappingURL=/sm/25ca8de397a18375fcaf24ffe960375ea57ee4e207e1bbff3a7f2b61750120a6.map