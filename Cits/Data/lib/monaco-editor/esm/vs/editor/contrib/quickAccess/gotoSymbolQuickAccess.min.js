/**
 * Minified by jsDelivr using Terser v5.7.1.
 * Original file: /npm/monaco-editor@0.27.0/esm/vs/editor/contrib/quickAccess/gotoSymbolQuickAccess.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
var __awaiter=this&&this.__awaiter||function(e,o,t,i){return new(t||(t=Promise))((function(r,n){function s(e){try{c(i.next(e))}catch(e){n(e)}}function a(e){try{c(i.throw(e))}catch(e){n(e)}}function c(e){var o;e.done?r(e.value):(o=e.value,o instanceof t?o:new t((function(e){e(o)}))).then(s,a)}c((i=i.apply(e,o||[])).next())}))};import{localize}from"../../../nls.js";import{CancellationTokenSource}from"../../../base/common/cancellation.js";import{DisposableStore,Disposable,toDisposable}from"../../../base/common/lifecycle.js";import{Range}from"../../common/core/range.js";import{AbstractEditorNavigationQuickAccessProvider}from"./editorNavigationQuickAccess.js";import{SymbolKinds,DocumentSymbolProviderRegistry}from"../../common/modes.js";import{OutlineModel}from"../documentSymbols/outlineModel.js";import{trim,format}from"../../../base/common/strings.js";import{prepareQuery,pieceToQuery,scoreFuzzy2}from"../../../base/common/fuzzyScorer.js";import{Codicon}from"../../../base/common/codicons.js";export class AbstractGotoSymbolQuickAccessProvider extends AbstractEditorNavigationQuickAccessProvider{constructor(e=Object.create(null)){super(e),this.options=e,this.options.canAcceptInBackground=!0}provideWithoutTextEditor(e){return this.provideLabelPick(e,localize("cannotRunGotoSymbolWithoutEditor","To go to a symbol, first open a text editor with symbol information.")),Disposable.None}provideWithTextEditor(e,o,t){const i=e.editor,r=this.getModel(i);return r?DocumentSymbolProviderRegistry.has(r)?this.doProvideWithEditorSymbols(e,r,o,t):this.doProvideWithoutEditorSymbols(e,r,o,t):Disposable.None}doProvideWithoutEditorSymbols(e,o,t,i){const r=new DisposableStore;return this.provideLabelPick(t,localize("cannotRunGotoSymbolWithoutSymbolProvider","The active text editor does not provide symbol information.")),(()=>{__awaiter(this,void 0,void 0,(function*(){(yield this.waitForLanguageSymbolRegistry(o,r))&&!i.isCancellationRequested&&r.add(this.doProvideWithEditorSymbols(e,o,t,i))}))})(),r}provideLabelPick(e,o){e.items=[{label:o,index:0,kind:14}],e.ariaLabel=o}waitForLanguageSymbolRegistry(e,o){return __awaiter(this,void 0,void 0,(function*(){if(DocumentSymbolProviderRegistry.has(e))return!0;let t;const i=new Promise((e=>t=e)),r=o.add(DocumentSymbolProviderRegistry.onDidChange((()=>{DocumentSymbolProviderRegistry.has(e)&&(r.dispose(),t(!0))})));return o.add(toDisposable((()=>t(!1)))),i}))}doProvideWithEditorSymbols(e,o,t,i){const r=e.editor,n=new DisposableStore;n.add(t.onDidAccept((o=>{const[i]=t.selectedItems;i&&i.range&&(this.gotoLocation(e,{range:i.range.selection,keyMods:t.keyMods,preserveFocus:o.inBackground}),o.inBackground||t.hide())}))),n.add(t.onDidTriggerItemButton((({item:o})=>{o&&o.range&&(this.gotoLocation(e,{range:o.range.selection,keyMods:t.keyMods,forceSideBySide:!0}),t.hide())})));const s=this.getDocumentSymbols(o,i);let a;const c=()=>__awaiter(this,void 0,void 0,(function*(){null==a||a.dispose(!0),t.busy=!1,a=new CancellationTokenSource(i),t.busy=!0;try{const e=prepareQuery(t.value.substr(AbstractGotoSymbolQuickAccessProvider.PREFIX.length).trim()),o=yield this.doGetSymbolPicks(s,e,void 0,a.token);if(i.isCancellationRequested)return;o.length>0?t.items=o:e.original.length>0?this.provideLabelPick(t,localize("noMatchingSymbolResults","No matching editor symbols")):this.provideLabelPick(t,localize("noSymbolResults","No editor symbols"))}finally{i.isCancellationRequested||(t.busy=!1)}}));n.add(t.onDidChangeValue((()=>c()))),c();let l=!0;return n.add(t.onDidChangeActive((()=>{const[e]=t.activeItems;if(e&&e.range){if(l)return void(l=!1);r.revealRangeInCenter(e.range.selection,0),this.addDecorations(r,e.range.decoration)}}))),n}doGetSymbolPicks(e,o,t,i){return __awaiter(this,void 0,void 0,(function*(){const r=yield e;if(i.isCancellationRequested)return[];const n=0===o.original.indexOf(AbstractGotoSymbolQuickAccessProvider.SCOPE_PREFIX),s=n?1:0;let a,c;o.values&&o.values.length>1?(a=pieceToQuery(o.values[0]),c=pieceToQuery(o.values.slice(1))):a=o;const l=[];for(let e=0;e<r.length;e++){const i=r[e],n=trim(i.name),d=`$(symbol-${SymbolKinds.toString(i.kind)||"property"}) ${n}`,u=d.length-n.length;let m,b,y,p,h=i.containerName;if((null==t?void 0:t.extraContainerLabel)&&(h=h?`${t.extraContainerLabel} â€¢ ${h}`:t.extraContainerLabel),o.original.length>s){let e=!1;if(a!==o&&([m,b]=scoreFuzzy2(d,Object.assign(Object.assign({},o),{values:void 0}),s,u),"number"==typeof m&&(e=!0)),"number"!=typeof m&&([m,b]=scoreFuzzy2(d,a,s,u),"number"!=typeof m))continue;if(!e&&c){if(h&&c.original.length>0&&([y,p]=scoreFuzzy2(h,c)),"number"!=typeof y)continue;"number"==typeof m&&(m+=y)}}const g=i.tags&&i.tags.indexOf(1)>=0;l.push({index:e,kind:i.kind,score:m,label:d,ariaLabel:n,description:h,highlights:g?void 0:{label:b,description:p},range:{selection:Range.collapseToStart(i.selectionRange),decoration:i.range},strikethrough:g,buttons:(()=>{var e,o;const t=(null===(e=this.options)||void 0===e?void 0:e.openSideBySideDirection)?null===(o=this.options)||void 0===o?void 0:o.openSideBySideDirection():void 0;if(t)return[{iconClass:"right"===t?Codicon.splitHorizontal.classNames:Codicon.splitVertical.classNames,tooltip:"right"===t?localize("openToSide","Open to the Side"):localize("openToBottom","Open to the Bottom")}]})()})}const d=l.sort(((e,o)=>n?this.compareByKindAndScore(e,o):this.compareByScore(e,o)));let u=[];if(n){let e,o,t=0;function i(){o&&"number"==typeof e&&t>0&&(o.label=format(NLS_SYMBOL_KIND_CACHE[e]||FALLBACK_NLS_SYMBOL_KIND,t))}for(const r of d)e!==r.kind?(i(),e=r.kind,t=1,o={type:"separator"},u.push(o)):t++,u.push(r);i()}else d.length>0&&(u=[{label:localize("symbols","symbols ({0})",l.length),type:"separator"},...d]);return u}))}compareByScore(e,o){if("number"!=typeof e.score&&"number"==typeof o.score)return 1;if("number"==typeof e.score&&"number"!=typeof o.score)return-1;if("number"==typeof e.score&&"number"==typeof o.score){if(e.score>o.score)return-1;if(e.score<o.score)return 1}return e.index<o.index?-1:e.index>o.index?1:0}compareByKindAndScore(e,o){const t=NLS_SYMBOL_KIND_CACHE[e.kind]||FALLBACK_NLS_SYMBOL_KIND,i=NLS_SYMBOL_KIND_CACHE[o.kind]||FALLBACK_NLS_SYMBOL_KIND,r=t.localeCompare(i);return 0===r?this.compareByScore(e,o):r}getDocumentSymbols(e,o){return __awaiter(this,void 0,void 0,(function*(){const t=yield OutlineModel.create(e,o);return o.isCancellationRequested?[]:t.asListOfDocumentSymbols()}))}}AbstractGotoSymbolQuickAccessProvider.PREFIX="@",AbstractGotoSymbolQuickAccessProvider.SCOPE_PREFIX=":",AbstractGotoSymbolQuickAccessProvider.PREFIX_BY_CATEGORY=`${AbstractGotoSymbolQuickAccessProvider.PREFIX}${AbstractGotoSymbolQuickAccessProvider.SCOPE_PREFIX}`;const FALLBACK_NLS_SYMBOL_KIND=localize("property","properties ({0})"),NLS_SYMBOL_KIND_CACHE={5:localize("method","methods ({0})"),11:localize("function","functions ({0})"),8:localize("_constructor","constructors ({0})"),12:localize("variable","variables ({0})"),4:localize("class","classes ({0})"),22:localize("struct","structs ({0})"),23:localize("event","events ({0})"),24:localize("operator","operators ({0})"),10:localize("interface","interfaces ({0})"),2:localize("namespace","namespaces ({0})"),3:localize("package","packages ({0})"),25:localize("typeParameter","type parameters ({0})"),1:localize("modules","modules ({0})"),6:localize("property","properties ({0})"),9:localize("enum","enumerations ({0})"),21:localize("enumMember","enumeration members ({0})"),14:localize("string","strings ({0})"),0:localize("file","files ({0})"),17:localize("array","arrays ({0})"),15:localize("number","numbers ({0})"),16:localize("boolean","booleans ({0})"),18:localize("object","objects ({0})"),19:localize("key","keys ({0})"),7:localize("field","fields ({0})"),13:localize("constant","constants ({0})")};
//# sourceMappingURL=/sm/dcd5af993e9312830a8afcb9dd51ecbcbb5b6f8ff0f4ef3b02ffb68c02e5f2db.map