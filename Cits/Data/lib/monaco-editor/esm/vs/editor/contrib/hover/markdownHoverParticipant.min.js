/**
 * Minified by jsDelivr using Terser v5.7.1.
 * Original file: /npm/monaco-editor@0.27.0/esm/vs/editor/contrib/hover/markdownHoverParticipant.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
var __decorate=this&&this.__decorate||function(e,r,o,n){var t,i=arguments.length,a=i<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,r,o,n);else for(var s=e.length-1;s>=0;s--)(t=e[s])&&(a=(i<3?t(a):i>3?t(r,o,a):t(r,o))||a);return i>3&&a&&Object.defineProperty(r,o,a),a},__param=this&&this.__param||function(e,r){return function(o,n){r(o,n,e)}},__awaiter=this&&this.__awaiter||function(e,r,o,n){return new(o||(o=Promise))((function(t,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var r;e.done?t(e.value):(r=e.value,r instanceof o?r:new o((function(e){e(r)}))).then(a,s)}c((n=n.apply(e,r||[])).next())}))};import*as nls from"../../../nls.js";import*as dom from"../../../base/browser/dom.js";import{MarkdownString,isEmptyMarkdownString}from"../../../base/common/htmlContent.js";import{DisposableStore}from"../../../base/common/lifecycle.js";import{Range}from"../../common/core/range.js";import{MarkdownRenderer}from"../../browser/core/markdownRenderer.js";import{asArray}from"../../../base/common/arrays.js";import{IOpenerService}from"../../../platform/opener/common/opener.js";import{IModeService}from"../../common/services/modeService.js";import{HoverProviderRegistry}from"../../common/modes.js";import{getHover}from"./getHover.js";import{Position}from"../../common/core/position.js";import{IConfigurationService}from"../../../platform/configuration/common/configuration.js";const $=dom.$;export class MarkdownHover{constructor(e,r,o){this.owner=e,this.range=r,this.contents=o}isValidForHoverAnchor(e){return 1===e.type&&this.range.startColumn<=e.range.startColumn&&this.range.endColumn>=e.range.endColumn}}let MarkdownHoverParticipant=class{constructor(e,r,o,n,t){this._editor=e,this._hover=r,this._modeService=o,this._openerService=n,this._configurationService=t}createLoadingMessage(e){return new MarkdownHover(this,e.range,[(new MarkdownString).appendText(nls.localize("modesContentHover.loading","Loading..."))])}computeSync(e,r){if(!this._editor.hasModel()||1!==e.type)return[];const o=this._editor.getModel(),n=e.range.startLineNumber,t=o.getLineMaxColumn(n),i=[];for(const o of r){const r=o.range.startLineNumber===n?o.range.startColumn:1,a=o.range.endLineNumber===n?o.range.endColumn:t,s=o.options.hoverMessage;if(!s||isEmptyMarkdownString(s))continue;const c=new Range(e.range.startLineNumber,r,e.range.startLineNumber,a);i.push(new MarkdownHover(this,c,asArray(s)))}const a=this._editor.getModel().getLineLength(n),s=this._configurationService.getValue("editor.maxTokenizationLineLength");return"number"==typeof s&&a>=s&&i.push(new MarkdownHover(this,new Range(n,1,n,a+1),[{value:nls.localize("too many characters","Tokenization is skipped for long lines for performance reasons. This can be configured via `editor.maxTokenizationLineLength`.")}])),i}computeAsync(e,r,o){return __awaiter(this,void 0,void 0,(function*(){if(!this._editor.hasModel()||1!==e.type)return Promise.resolve([]);const r=this._editor.getModel();if(!HoverProviderRegistry.has(r))return Promise.resolve([]);const n=yield getHover(r,new Position(e.range.startLineNumber,e.range.startColumn),o),t=[];for(const r of n){if(isEmptyMarkdownString(r.contents))continue;const o=r.range?Range.lift(r.range):e.range;t.push(new MarkdownHover(this,o,r.contents))}return t}))}renderHoverParts(e,r,o){const n=new DisposableStore;for(const o of e)for(const e of o.contents){if(isEmptyMarkdownString(e))continue;const o=$("div.hover-row.markdown-hover"),t=dom.append(o,$("div.hover-contents")),i=n.add(new MarkdownRenderer({editor:this._editor},this._modeService,this._openerService));n.add(i.onDidRenderAsync((()=>{t.className="hover-contents code-hover-contents",this._hover.onContentsChanged()})));const a=n.add(i.render(e));t.appendChild(a.element),r.appendChild(o)}return n}};MarkdownHoverParticipant=__decorate([__param(2,IModeService),__param(3,IOpenerService),__param(4,IConfigurationService)],MarkdownHoverParticipant);export{MarkdownHoverParticipant};
//# sourceMappingURL=/sm/26efb730e13e0a739422f7567277337f43a8365b8b611fd8eb8bd2599bea281f.map