/**
 * Minified by jsDelivr using Terser v5.7.1.
 * Original file: /npm/monaco-editor@0.27.0/esm/vs/editor/contrib/hover/modesGlyphHover.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import{$}from"../../../base/browser/dom.js";import{isEmptyMarkdownString}from"../../../base/common/htmlContent.js";import{DisposableStore}from"../../../base/common/lifecycle.js";import{HoverOperation}from"./hoverOperation.js";import{GlyphHoverWidget}from"./hoverWidgets.js";import{MarkdownRenderer}from"../../browser/core/markdownRenderer.js";import{NullOpenerService}from"../../../platform/opener/common/opener.js";import{asArray}from"../../../base/common/arrays.js";class MarginComputer{constructor(e){this._editor=e,this._lineNumber=-1,this._result=[]}setLineNumber(e){this._lineNumber=e,this._result=[]}clearResult(){this._result=[]}computeSync(){const e=e=>({value:e}),t=this._editor.getLineDecorations(this._lineNumber),s=[];if(!t)return s;for(const r of t){if(!r.options.glyphMarginClassName)continue;const t=r.options.glyphMarginHoverMessage;t&&!isEmptyMarkdownString(t)&&s.push(...asArray(t).map(e))}return s}onResult(e,t){this._result=this._result.concat(e)}getResult(){return this._result}getResultWithLoadingMessage(){return this.getResult()}}export class ModesGlyphHoverWidget extends GlyphHoverWidget{constructor(e,t,s=NullOpenerService){super(ModesGlyphHoverWidget.ID,e),this._renderDisposeables=this._register(new DisposableStore),this._messages=[],this._lastLineNumber=-1,this._markdownRenderer=this._register(new MarkdownRenderer({editor:this._editor},t,s)),this._computer=new MarginComputer(this._editor),this._hoverOperation=new HoverOperation(this._computer,(e=>this._withResult(e)),void 0,(e=>this._withResult(e)),300)}dispose(){this._hoverOperation.cancel(),super.dispose()}onModelDecorationsChanged(){this.isVisible&&(this._hoverOperation.cancel(),this._computer.clearResult(),this._hoverOperation.start(0))}startShowingAt(e){this._lastLineNumber!==e&&(this._hoverOperation.cancel(),this.hide(),this._lastLineNumber=e,this._computer.setLineNumber(e),this._hoverOperation.start(0))}hide(){this._lastLineNumber=-1,this._hoverOperation.cancel(),super.hide()}_withResult(e){this._messages=e,this._messages.length>0?this._renderMessages(this._lastLineNumber,this._messages):this.hide()}_renderMessages(e,t){this._renderDisposeables.clear();const s=document.createDocumentFragment();for(const e of t){const t=this._markdownRenderer.render(e.value);this._renderDisposeables.add(t),s.appendChild($("div.hover-row",void 0,t.element))}this.updateContents(s),this.showAt(e)}}ModesGlyphHoverWidget.ID="editor.contrib.modesGlyphHoverWidget";
//# sourceMappingURL=/sm/47d00adfe57107ada5b6cdc2c3abbd4f971745a0c3e0c702e7aec15fc2757110.map