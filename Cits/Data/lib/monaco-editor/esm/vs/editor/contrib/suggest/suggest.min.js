/**
 * Minified by jsDelivr using Terser v5.7.1.
 * Original file: /npm/monaco-editor@0.27.0/esm/vs/editor/contrib/suggest/suggest.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
var __awaiter=this&&this.__awaiter||function(e,t,o,i){return new(o||(o=Promise))((function(s,n){function r(e){try{l(i.next(e))}catch(e){n(e)}}function a(e){try{l(i.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,a)}l((i=i.apply(e,t||[])).next())}))};import{onUnexpectedExternalError,canceled,isPromiseCanceledError}from"../../../base/common/errors.js";import*as modes from"../../common/modes.js";import{Position}from"../../common/core/position.js";import{RawContextKey}from"../../../platform/contextkey/common/contextkey.js";import{CancellationToken}from"../../../base/common/cancellation.js";import{Range}from"../../common/core/range.js";import{FuzzyScore}from"../../../base/common/filters.js";import{isDisposable,DisposableStore}from"../../../base/common/lifecycle.js";import{MenuId}from"../../../platform/actions/common/actions.js";import{SnippetParser}from"../snippet/snippetParser.js";import{StopWatch}from"../../../base/common/stopwatch.js";import{CommandsRegistry}from"../../../platform/commands/common/commands.js";import{assertType}from"../../../base/common/types.js";import{URI}from"../../../base/common/uri.js";import{ITextModelService}from"../../common/services/resolverService.js";import{localize}from"../../../nls.js";export const Context={Visible:new RawContextKey("suggestWidgetVisible",!1,localize("suggestWidgetVisible","Whether suggestion are visible")),DetailsVisible:new RawContextKey("suggestWidgetDetailsVisible",!1,localize("suggestWidgetDetailsVisible","Whether suggestion details are visible")),MultipleSuggestions:new RawContextKey("suggestWidgetMultipleSuggestions",!1,localize("suggestWidgetMultipleSuggestions","Whether there are multiple suggestions to pick from")),MakesTextEdit:new RawContextKey("suggestionMakesTextEdit",!0,localize("suggestionMakesTextEdit","Whether inserting the current suggestion yields in a change or has everything already been typed")),AcceptSuggestionsOnEnter:new RawContextKey("acceptSuggestionOnEnter",!0,localize("acceptSuggestionOnEnter","Whether suggestions are inserted when pressing Enter")),HasInsertAndReplaceRange:new RawContextKey("suggestionHasInsertAndReplaceRange",!1,localize("suggestionHasInsertAndReplaceRange","Whether the current suggestion has insert and replace behaviour")),InsertMode:new RawContextKey("suggestionInsertMode",void 0,{type:"string",description:localize("suggestionInsertMode","Whether the default behaviour is to insert or replace")}),CanResolve:new RawContextKey("suggestionCanResolve",!1,localize("suggestionCanResolve","Whether the current suggestion supports to resolve further details"))};export const suggestWidgetStatusbarMenu=new MenuId("suggestWidgetStatusBar");export class CompletionItem{constructor(e,t,o,i){this.position=e,this.completion=t,this.container=o,this.provider=i,this.isInvalid=!1,this.score=FuzzyScore.Default,this.distance=0,this.textLabel="string"==typeof t.label?t.label:t.label.label,this.labelLow=this.textLabel.toLowerCase(),this.isInvalid=!this.textLabel,this.sortTextLow=t.sortText&&t.sortText.toLowerCase(),this.filterTextLow=t.filterText&&t.filterText.toLowerCase(),Range.isIRange(t.range)?(this.editStart=new Position(t.range.startLineNumber,t.range.startColumn),this.editInsertEnd=new Position(t.range.endLineNumber,t.range.endColumn),this.editReplaceEnd=new Position(t.range.endLineNumber,t.range.endColumn),this.isInvalid=this.isInvalid||Range.spansMultipleLines(t.range)||t.range.startLineNumber!==e.lineNumber):(this.editStart=new Position(t.range.insert.startLineNumber,t.range.insert.startColumn),this.editInsertEnd=new Position(t.range.insert.endLineNumber,t.range.insert.endColumn),this.editReplaceEnd=new Position(t.range.replace.endLineNumber,t.range.replace.endColumn),this.isInvalid=this.isInvalid||Range.spansMultipleLines(t.range.insert)||Range.spansMultipleLines(t.range.replace)||t.range.insert.startLineNumber!==e.lineNumber||t.range.replace.startLineNumber!==e.lineNumber||t.range.insert.startColumn!==t.range.replace.startColumn),"function"!=typeof i.resolveCompletionItem&&(this._resolveCache=Promise.resolve(),this._isResolved=!0)}get isResolved(){return!!this._isResolved}resolve(e){return __awaiter(this,void 0,void 0,(function*(){if(!this._resolveCache){const t=e.onCancellationRequested((()=>{this._resolveCache=void 0,this._isResolved=!1}));this._resolveCache=Promise.resolve(this.provider.resolveCompletionItem(this.completion,e)).then((e=>{Object.assign(this.completion,e),this._isResolved=!0,t.dispose()}),(e=>{isPromiseCanceledError(e)&&(this._resolveCache=void 0,this._isResolved=!1)}))}return this._resolveCache}))}}export class CompletionOptions{constructor(e=2,t=new Set,o=new Set,i=!0){this.snippetSortOrder=e,this.kindFilter=t,this.providerFilter=o,this.showDeprecated=i}}let _snippetSuggestSupport;CompletionOptions.default=new CompletionOptions;export function getSnippetSuggestSupport(){return _snippetSuggestSupport}export class CompletionItemModel{constructor(e,t,o,i){this.items=e,this.needsClipboard=t,this.durations=o,this.disposable=i}}export function provideSuggestionItems(e,t,o=CompletionOptions.default,i={triggerKind:0},s=CancellationToken.None){return __awaiter(this,void 0,void 0,(function*(){const n=new StopWatch(!0);t=t.clone();const r=e.getWordAtPosition(t),a=r?new Range(t.lineNumber,r.startColumn,t.lineNumber,r.endColumn):Range.fromPositions(t),l={replace:a,insert:a.setEndPosition(t.lineNumber,t.column)},p=[],d=new DisposableStore,c=[];let m=!1;const u=(e,i,s)=>{var n,r,a;if(i){for(let s of i.suggestions)if(!o.kindFilter.has(s.kind)){if(!o.showDeprecated&&(null===(n=null==s?void 0:s.tags)||void 0===n?void 0:n.includes(1)))continue;s.range||(s.range=l),s.sortText||(s.sortText="string"==typeof s.label?s.label:s.label.label),!m&&s.insertTextRules&&4&s.insertTextRules&&(m=SnippetParser.guessNeedsClipboard(s.insertText)),p.push(new CompletionItem(t,s,i,e))}isDisposable(i)&&d.add(i),c.push({providerName:null!==(r=e._debugDisplayName)&&void 0!==r?r:"unkown_provider",elapsedProvider:null!==(a=i.duration)&&void 0!==a?a:-1,elapsedOverall:s.elapsed()})}},g=(()=>__awaiter(this,void 0,void 0,(function*(){if(!_snippetSuggestSupport||o.kindFilter.has(27))return;if(o.providerFilter.size>0&&!o.providerFilter.has(_snippetSuggestSupport))return;const n=new StopWatch(!0),r=yield _snippetSuggestSupport.provideCompletionItems(e,t,i,s);u(_snippetSuggestSupport,r,n)})))();for(let n of modes.CompletionProviderRegistry.orderedGroups(e)){let r=p.length;if(yield Promise.all(n.map((n=>__awaiter(this,void 0,void 0,(function*(){if(!(o.providerFilter.size>0)||o.providerFilter.has(n))try{const o=new StopWatch(!0),r=yield n.provideCompletionItems(e,t,i,s);u(n,r,o)}catch(e){onUnexpectedExternalError(e)}}))))),r!==p.length||s.isCancellationRequested)break}return yield g,s.isCancellationRequested?(d.dispose(),Promise.reject(canceled())):new CompletionItemModel(p.sort(getSuggestionComparator(o.snippetSortOrder)),m,{entries:c,elapsed:n.elapsed()},d)}))}function defaultComparator(e,t){if(e.sortTextLow&&t.sortTextLow){if(e.sortTextLow<t.sortTextLow)return-1;if(e.sortTextLow>t.sortTextLow)return 1}return e.completion.label<t.completion.label?-1:e.completion.label>t.completion.label?1:e.completion.kind-t.completion.kind}function snippetUpComparator(e,t){if(e.completion.kind!==t.completion.kind){if(27===e.completion.kind)return-1;if(27===t.completion.kind)return 1}return defaultComparator(e,t)}function snippetDownComparator(e,t){if(e.completion.kind!==t.completion.kind){if(27===e.completion.kind)return 1;if(27===t.completion.kind)return-1}return defaultComparator(e,t)}const _snippetComparators=new Map;_snippetComparators.set(0,snippetUpComparator),_snippetComparators.set(2,snippetDownComparator),_snippetComparators.set(1,defaultComparator);export function getSuggestionComparator(e){return _snippetComparators.get(e)}CommandsRegistry.registerCommand("_executeCompletionItemProvider",((e,...t)=>__awaiter(void 0,void 0,void 0,(function*(){const[o,i,s,n]=t;assertType(URI.isUri(o)),assertType(Position.isIPosition(i)),assertType("string"==typeof s||!s),assertType("number"==typeof n||!n);const r=yield e.get(ITextModelService).createModelReference(o);try{const e={incomplete:!1,suggestions:[]},t=[],o=yield provideSuggestionItems(r.object.textEditorModel,Position.lift(i),void 0,{triggerCharacter:s,triggerKind:s?1:0});for(const i of o.items)t.length<(null!=n?n:0)&&t.push(i.resolve(CancellationToken.None)),e.incomplete=e.incomplete||i.container.incomplete,e.suggestions.push(i.completion);try{return yield Promise.all(t),e}finally{setTimeout((()=>o.disposable.dispose()),100)}}finally{r.dispose()}}))));const _provider=new class{constructor(){this.onlyOnceSuggestions=[]}provideCompletionItems(){let e={suggestions:this.onlyOnceSuggestions.slice(0)};return this.onlyOnceSuggestions.length=0,e}};modes.CompletionProviderRegistry.register("*",_provider);export function showSimpleSuggestions(e,t){setTimeout((()=>{_provider.onlyOnceSuggestions.push(...t),e.getContribution("editor.contrib.suggestController").triggerSuggest((new Set).add(_provider))}),0)}
//# sourceMappingURL=/sm/015b3d725f3eda6801f0c2f4e0ebfe635d32ed3b1163cf2db68ccb3bbb8b87e2.map