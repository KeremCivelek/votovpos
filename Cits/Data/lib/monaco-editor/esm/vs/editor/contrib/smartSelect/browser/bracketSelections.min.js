/**
 * Minified by jsDelivr using Terser v5.10.0.
 * Original file: /npm/monaco-editor@0.33.0/esm/vs/editor/contrib/smartSelect/browser/bracketSelections.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
var __awaiter=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(o,a){function r(e){try{c(i.next(e))}catch(e){a(e)}}function s(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,s)}c((i=i.apply(e,t||[])).next())}))};import{LinkedList}from"../../../../base/common/linkedList.js";import{Position}from"../../../common/core/position.js";import{Range}from"../../../common/core/range.js";export class BracketSelectionRangeProvider{provideSelectionRanges(e,t){return __awaiter(this,void 0,void 0,(function*(){const n=[];for(const i of t){const t=[];n.push(t);const o=new Map;yield new Promise((t=>BracketSelectionRangeProvider._bracketsRightYield(t,0,e,i,o))),yield new Promise((n=>BracketSelectionRangeProvider._bracketsLeftYield(n,0,e,i,o,t)))}return n}))}static _bracketsRightYield(e,t,n,i,o){const a=new Map,r=Date.now();for(;;){if(t>=BracketSelectionRangeProvider._maxRounds){e();break}if(!i){e();break}let s=n.bracketPairs.findNextBracket(i);if(!s){e();break}if(Date.now()-r>BracketSelectionRangeProvider._maxDuration){setTimeout((()=>BracketSelectionRangeProvider._bracketsRightYield(e,t+1,n,i,o)));break}const c=s.close[0];if(s.isOpen){let e=a.has(c)?a.get(c):0;a.set(c,e+1)}else{let e=a.has(c)?a.get(c):0;if(e-=1,a.set(c,Math.max(0,e)),e<0){let e=o.get(c);e||(e=new LinkedList,o.set(c,e)),e.push(s.range)}}i=s.range.getEndPosition()}}static _bracketsLeftYield(e,t,n,i,o,a){const r=new Map,s=Date.now();for(;;){if(t>=BracketSelectionRangeProvider._maxRounds&&0===o.size){e();break}if(!i){e();break}let c=n.bracketPairs.findPrevBracket(i);if(!c){e();break}if(Date.now()-s>BracketSelectionRangeProvider._maxDuration){setTimeout((()=>BracketSelectionRangeProvider._bracketsLeftYield(e,t+1,n,i,o,a)));break}const g=c.close[0];if(c.isOpen){let e=r.has(g)?r.get(g):0;if(e-=1,r.set(g,Math.max(0,e)),e<0){let e=o.get(g);if(e){let t=e.shift();0===e.size&&o.delete(g);const i=Range.fromPositions(c.range.getEndPosition(),t.getStartPosition()),r=Range.fromPositions(c.range.getStartPosition(),t.getEndPosition());a.push({range:i}),a.push({range:r}),BracketSelectionRangeProvider._addBracketLeading(n,r,a)}}}else{let e=r.has(g)?r.get(g):0;r.set(g,e+1)}i=c.range.getStartPosition()}}static _addBracketLeading(e,t,n){if(t.startLineNumber===t.endLineNumber)return;const i=t.startLineNumber,o=e.getLineFirstNonWhitespaceColumn(i);0!==o&&o!==t.startColumn&&(n.push({range:Range.fromPositions(new Position(i,o),t.getEndPosition())}),n.push({range:Range.fromPositions(new Position(i,1),t.getEndPosition())}));const a=i-1;if(a>0){const i=e.getLineFirstNonWhitespaceColumn(a);i===t.startColumn&&i!==e.getLineLastNonWhitespaceColumn(a)&&(n.push({range:Range.fromPositions(new Position(a,i),t.getEndPosition())}),n.push({range:Range.fromPositions(new Position(a,1),t.getEndPosition())}))}}}BracketSelectionRangeProvider._maxDuration=30,BracketSelectionRangeProvider._maxRounds=2;
//# sourceMappingURL=/sm/a64c70510254bb83935964d2d682edd5762a6fdd8230c87984336ee3b80f7b6c.map