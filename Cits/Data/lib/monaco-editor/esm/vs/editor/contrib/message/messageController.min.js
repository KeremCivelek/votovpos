/**
 * Minified by jsDelivr using Terser v5.7.1.
 * Original file: /npm/monaco-editor@0.27.0/esm/vs/editor/contrib/message/messageController.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
var __decorate=this&&this.__decorate||function(e,t,o,s){var i,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,o):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,o,s);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(n=(r<3?i(n):r>3?i(t,o,n):i(t,o))||n);return r>3&&n&&Object.defineProperty(t,o,n),n},__param=this&&this.__param||function(e,t){return function(o,s){t(o,s,e)}};import"./messageController.css";import*as nls from"../../../nls.js";import{TimeoutTimer}from"../../../base/common/async.js";import{DisposableStore,MutableDisposable}from"../../../base/common/lifecycle.js";import{alert}from"../../../base/browser/ui/aria/aria.js";import{Range}from"../../common/core/range.js";import{registerEditorContribution,EditorCommand,registerEditorCommand}from"../../browser/editorExtensions.js";import{IContextKeyService,RawContextKey}from"../../../platform/contextkey/common/contextkey.js";import{registerThemingParticipant}from"../../../platform/theme/common/themeService.js";import{inputValidationInfoBorder,inputValidationInfoBackground,inputValidationInfoForeground}from"../../../platform/theme/common/colorRegistry.js";import{ColorScheme}from"../../../platform/theme/common/theme.js";let MessageController=class e{constructor(t,o){this._messageWidget=new MutableDisposable,this._messageListeners=new DisposableStore,this._editor=t,this._visible=e.MESSAGE_VISIBLE.bindTo(o),this._editorListener=this._editor.onDidAttemptReadOnlyEdit((()=>this._onDidAttemptReadOnlyEdit()))}static get(t){return t.getContribution(e.ID)}dispose(){this._editorListener.dispose(),this._messageListeners.dispose(),this._messageWidget.dispose(),this._visible.reset()}showMessage(e,t){let o;alert(e),this._visible.set(!0),this._messageWidget.clear(),this._messageListeners.clear(),this._messageWidget.value=new MessageWidget(this._editor,t,e),this._messageListeners.add(this._editor.onDidBlurEditorText((()=>this.closeMessage()))),this._messageListeners.add(this._editor.onDidChangeCursorPosition((()=>this.closeMessage()))),this._messageListeners.add(this._editor.onDidDispose((()=>this.closeMessage()))),this._messageListeners.add(this._editor.onDidChangeModel((()=>this.closeMessage()))),this._messageListeners.add(new TimeoutTimer((()=>this.closeMessage()),3e3)),this._messageListeners.add(this._editor.onMouseMove((e=>{e.target.position&&(o?o.containsPosition(e.target.position)||this.closeMessage():o=new Range(t.lineNumber-3,1,e.target.position.lineNumber+3,1))})))}closeMessage(){this._visible.reset(),this._messageListeners.clear(),this._messageWidget.value&&this._messageListeners.add(MessageWidget.fadeOut(this._messageWidget.value))}_onDidAttemptReadOnlyEdit(){this._editor.hasModel()&&this.showMessage(nls.localize("editor.readonly","Cannot edit in read-only editor"),this._editor.getPosition())}};MessageController.ID="editor.contrib.messageController",MessageController.MESSAGE_VISIBLE=new RawContextKey("messageVisible",!1,nls.localize("messageVisible","Whether the editor is currently showing an inline message")),MessageController=__decorate([__param(1,IContextKeyService)],MessageController);export{MessageController};const MessageCommand=EditorCommand.bindToContribution(MessageController.get);registerEditorCommand(new MessageCommand({id:"leaveEditorMessage",precondition:MessageController.MESSAGE_VISIBLE,handler:e=>e.closeMessage(),kbOpts:{weight:130,primary:9}}));class MessageWidget{constructor(e,{lineNumber:t,column:o},s){this.allowEditorOverflow=!0,this.suppressMouseDown=!1,this._editor=e,this._editor.revealLinesInCenterIfOutsideViewport(t,t,0),this._position={lineNumber:t,column:o-1},this._domNode=document.createElement("div"),this._domNode.classList.add("monaco-editor-overlaymessage");const i=document.createElement("div");i.classList.add("anchor","top"),this._domNode.appendChild(i);const r=document.createElement("div");r.classList.add("message"),r.textContent=s,this._domNode.appendChild(r);const n=document.createElement("div");n.classList.add("anchor","below"),this._domNode.appendChild(n),this._editor.addContentWidget(this),this._domNode.classList.add("fadeIn")}static fadeOut(e){let t;const o=()=>{e.dispose(),clearTimeout(t),e.getDomNode().removeEventListener("animationend",o)};return t=setTimeout(o,110),e.getDomNode().addEventListener("animationend",o),e.getDomNode().classList.add("fadeOut"),{dispose:o}}dispose(){this._editor.removeContentWidget(this)}getId(){return"messageoverlay"}getDomNode(){return this._domNode}getPosition(){return{position:this._position,preference:[1,2]}}afterRender(e){this._domNode.classList.toggle("below",2===e)}}registerEditorContribution(MessageController.ID,MessageController),registerThemingParticipant(((e,t)=>{const o=e.getColor(inputValidationInfoBorder);if(o){let s=e.type===ColorScheme.HIGH_CONTRAST?2:1;t.addRule(`.monaco-editor .monaco-editor-overlaymessage .anchor.below { border-top-color: ${o}; }`),t.addRule(`.monaco-editor .monaco-editor-overlaymessage .anchor.top { border-bottom-color: ${o}; }`),t.addRule(`.monaco-editor .monaco-editor-overlaymessage .message { border: ${s}px solid ${o}; }`)}const s=e.getColor(inputValidationInfoBackground);s&&t.addRule(`.monaco-editor .monaco-editor-overlaymessage .message { background-color: ${s}; }`);const i=e.getColor(inputValidationInfoForeground);i&&t.addRule(`.monaco-editor .monaco-editor-overlaymessage .message { color: ${i}; }`)}));
//# sourceMappingURL=/sm/a6b1dc1fe8f1ee0d13edb9b61e360ea5b9c9fd1869ca4d9317129d9868675d1d.map