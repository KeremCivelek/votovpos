/**
 * Minified by jsDelivr using Terser v5.7.1.
 * Original file: /npm/monaco-editor@0.27.0/esm/vs/editor/common/controller/cursorCollection.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import{CursorState}from"./cursorCommon.js";import{Cursor}from"./oneCursor.js";import{Selection}from"../core/selection.js";export class CursorCollection{constructor(t){this.context=t,this.primaryCursor=new Cursor(t),this.secondaryCursors=[],this.lastAddedCursorIndex=0}dispose(){this.primaryCursor.dispose(this.context),this.killSecondaryCursors()}startTrackingSelections(){this.primaryCursor.startTrackingSelection(this.context);for(let t=0,e=this.secondaryCursors.length;t<e;t++)this.secondaryCursors[t].startTrackingSelection(this.context)}stopTrackingSelections(){this.primaryCursor.stopTrackingSelection(this.context);for(let t=0,e=this.secondaryCursors.length;t<e;t++)this.secondaryCursors[t].stopTrackingSelection(this.context)}updateContext(t){this.context=t}ensureValidState(){this.primaryCursor.ensureValidState(this.context);for(let t=0,e=this.secondaryCursors.length;t<e;t++)this.secondaryCursors[t].ensureValidState(this.context)}readSelectionFromMarkers(){let t=[];t[0]=this.primaryCursor.readSelectionFromMarkers(this.context);for(let e=0,s=this.secondaryCursors.length;e<s;e++)t[e+1]=this.secondaryCursors[e].readSelectionFromMarkers(this.context);return t}getAll(){let t=[];t[0]=this.primaryCursor.asCursorState();for(let e=0,s=this.secondaryCursors.length;e<s;e++)t[e+1]=this.secondaryCursors[e].asCursorState();return t}getViewPositions(){let t=[];t[0]=this.primaryCursor.viewState.position;for(let e=0,s=this.secondaryCursors.length;e<s;e++)t[e+1]=this.secondaryCursors[e].viewState.position;return t}getTopMostViewPosition(){let t=this.primaryCursor.viewState.position;for(let e=0,s=this.secondaryCursors.length;e<s;e++){const s=this.secondaryCursors[e].viewState.position;s.isBefore(t)&&(t=s)}return t}getBottomMostViewPosition(){let t=this.primaryCursor.viewState.position;for(let e=0,s=this.secondaryCursors.length;e<s;e++){const s=this.secondaryCursors[e].viewState.position;t.isBeforeOrEqual(s)&&(t=s)}return t}getSelections(){let t=[];t[0]=this.primaryCursor.modelState.selection;for(let e=0,s=this.secondaryCursors.length;e<s;e++)t[e+1]=this.secondaryCursors[e].modelState.selection;return t}getViewSelections(){let t=[];t[0]=this.primaryCursor.viewState.selection;for(let e=0,s=this.secondaryCursors.length;e<s;e++)t[e+1]=this.secondaryCursors[e].viewState.selection;return t}setSelections(t){this.setStates(CursorState.fromModelSelections(t))}getPrimaryCursor(){return this.primaryCursor.asCursorState()}setStates(t){null!==t&&(this.primaryCursor.setState(this.context,t[0].modelState,t[0].viewState),this._setSecondaryStates(t.slice(1)))}_setSecondaryStates(t){const e=this.secondaryCursors.length,s=t.length;if(e<s){let t=s-e;for(let e=0;e<t;e++)this._addSecondaryCursor()}else if(e>s){let t=e-s;for(let e=0;e<t;e++)this._removeSecondaryCursor(this.secondaryCursors.length-1)}for(let e=0;e<s;e++)this.secondaryCursors[e].setState(this.context,t[e].modelState,t[e].viewState)}killSecondaryCursors(){this._setSecondaryStates([])}_addSecondaryCursor(){this.secondaryCursors.push(new Cursor(this.context)),this.lastAddedCursorIndex=this.secondaryCursors.length}getLastAddedCursorIndex(){return 0===this.secondaryCursors.length||0===this.lastAddedCursorIndex?0:this.lastAddedCursorIndex}_removeSecondaryCursor(t){this.lastAddedCursorIndex>=t+1&&this.lastAddedCursorIndex--,this.secondaryCursors[t].dispose(this.context),this.secondaryCursors.splice(t,1)}_getAll(){let t=[];t[0]=this.primaryCursor;for(let e=0,s=this.secondaryCursors.length;e<s;e++)t[e+1]=this.secondaryCursors[e];return t}normalize(){if(0===this.secondaryCursors.length)return;let t=this._getAll(),e=[];for(let s=0,r=t.length;s<r;s++)e.push({index:s,selection:t[s].modelState.selection});e.sort(((t,e)=>t.selection.startLineNumber===e.selection.startLineNumber?t.selection.startColumn-e.selection.startColumn:t.selection.startLineNumber-e.selection.startLineNumber));for(let s=0;s<e.length-1;s++){const r=e[s],o=e[s+1],i=r.selection,n=o.selection;if(!this.context.cursorConfig.multiCursorMergeOverlapping)continue;let a;if(a=n.isEmpty()||i.isEmpty()?n.getStartPosition().isBeforeOrEqual(i.getEndPosition()):n.getStartPosition().isBefore(i.getEndPosition()),a){const i=r.index<o.index?s:s+1,n=r.index<o.index?s+1:s,a=e[n].index,l=e[i].index,c=e[n].selection,u=e[i].selection;if(!c.equalsSelection(u)){const s=c.plusRange(u),r=c.selectionStartLineNumber===c.startLineNumber&&c.selectionStartColumn===c.startColumn,o=u.selectionStartLineNumber===u.startLineNumber&&u.selectionStartColumn===u.startColumn;let n,d;a===this.lastAddedCursorIndex?(n=r,this.lastAddedCursorIndex=l):n=o,d=n?new Selection(s.startLineNumber,s.startColumn,s.endLineNumber,s.endColumn):new Selection(s.endLineNumber,s.endColumn,s.startLineNumber,s.startColumn),e[i].selection=d;const h=CursorState.fromModelSelection(d);t[l].setState(this.context,h.modelState,h.viewState)}for(const t of e)t.index>a&&t.index--;t.splice(a,1),e.splice(n,1),this._removeSecondaryCursor(a-1),s--}}}}
//# sourceMappingURL=/sm/0cf0cc7259384a87961cbae382bb51e206eb2dd7b9a7bea50bbe0f94a6f850f1.map