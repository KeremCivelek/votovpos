/**
 * Minified by jsDelivr using Terser v5.7.1.
 * Original file: /npm/monaco-editor@0.27.0/esm/vs/editor/common/controller/cursorCommon.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import{onUnexpectedError}from"../../../base/common/errors.js";import*as strings from"../../../base/common/strings.js";import{Position}from"../core/position.js";import{Range}from"../core/range.js";import{Selection}from"../core/selection.js";import{TextModel}from"../model/textModel.js";import{LanguageConfigurationRegistry}from"../modes/languageConfigurationRegistry.js";const autoCloseAlways=()=>!0,autoCloseNever=()=>!1,autoCloseBeforeWhitespace=t=>" "===t||"\t"===t;export class CursorConfiguration{constructor(t,e,r){this._cursorMoveConfigurationBrand=void 0,this._languageIdentifier=t;const s=r.options,i=s.get(129);this.readOnly=s.get(79),this.tabSize=e.tabSize,this.indentSize=e.indentSize,this.insertSpaces=e.insertSpaces,this.stickyTabStops=s.get(103),this.lineHeight=s.get(57),this.pageSize=Math.max(1,Math.floor(i.height/this.lineHeight)-2),this.useTabStops=s.get(114),this.wordSeparators=s.get(115),this.emptySelectionClipboard=s.get(30),this.copyWithSyntaxHighlighting=s.get(19),this.multiCursorMergeOverlapping=s.get(67),this.multiCursorPaste=s.get(69),this.autoClosingBrackets=s.get(5),this.autoClosingQuotes=s.get(8),this.autoClosingDelete=s.get(6),this.autoClosingOvertype=s.get(7),this.autoSurround=s.get(11),this.autoIndent=s.get(9),this.surroundingPairs={},this._electricChars=null,this.shouldAutoCloseBefore={quote:CursorConfiguration._getShouldAutoClose(t,this.autoClosingQuotes),bracket:CursorConfiguration._getShouldAutoClose(t,this.autoClosingBrackets)},this.autoClosingPairs=LanguageConfigurationRegistry.getAutoClosingPairs(t.id);let o=CursorConfiguration._getSurroundingPairs(t);if(o)for(const t of o)this.surroundingPairs[t.open]=t.close}static shouldRecreate(t){return t.hasChanged(129)||t.hasChanged(115)||t.hasChanged(30)||t.hasChanged(67)||t.hasChanged(69)||t.hasChanged(5)||t.hasChanged(8)||t.hasChanged(6)||t.hasChanged(7)||t.hasChanged(11)||t.hasChanged(114)||t.hasChanged(57)||t.hasChanged(79)}get electricChars(){if(!this._electricChars){this._electricChars={};let t=CursorConfiguration._getElectricCharacters(this._languageIdentifier);if(t)for(const e of t)this._electricChars[e]=!0}return this._electricChars}normalizeIndentation(t){return TextModel.normalizeIndentation(t,this.indentSize,this.insertSpaces)}static _getElectricCharacters(t){try{return LanguageConfigurationRegistry.getElectricCharacters(t.id)}catch(t){return onUnexpectedError(t),null}}static _getShouldAutoClose(t,e){switch(e){case"beforeWhitespace":return autoCloseBeforeWhitespace;case"languageDefined":return CursorConfiguration._getLanguageDefinedShouldAutoClose(t);case"always":return autoCloseAlways;case"never":return autoCloseNever}}static _getLanguageDefinedShouldAutoClose(t){try{const e=LanguageConfigurationRegistry.getAutoCloseBeforeSet(t.id);return t=>-1!==e.indexOf(t)}catch(t){return onUnexpectedError(t),autoCloseNever}}static _getSurroundingPairs(t){try{return LanguageConfigurationRegistry.getSurroundingPairs(t.id)}catch(t){return onUnexpectedError(t),null}}}export class SingleCursorState{constructor(t,e,r,s){this._singleCursorStateBrand=void 0,this.selectionStart=t,this.selectionStartLeftoverVisibleColumns=e,this.position=r,this.leftoverVisibleColumns=s,this.selection=SingleCursorState._computeSelection(this.selectionStart,this.position)}equals(t){return this.selectionStartLeftoverVisibleColumns===t.selectionStartLeftoverVisibleColumns&&this.leftoverVisibleColumns===t.leftoverVisibleColumns&&this.position.equals(t.position)&&this.selectionStart.equalsRange(t.selectionStart)}hasSelection(){return!this.selection.isEmpty()||!this.selectionStart.isEmpty()}move(t,e,r,s){return t?new SingleCursorState(this.selectionStart,this.selectionStartLeftoverVisibleColumns,new Position(e,r),s):new SingleCursorState(new Range(e,r,e,r),s,new Position(e,r),s)}static _computeSelection(t,e){let r,s,i,o;return t.isEmpty()?(r=t.startLineNumber,s=t.startColumn,i=e.lineNumber,o=e.column):e.isBeforeOrEqual(t.getStartPosition())?(r=t.endLineNumber,s=t.endColumn,i=e.lineNumber,o=e.column):(r=t.startLineNumber,s=t.startColumn,i=e.lineNumber,o=e.column),new Selection(r,s,i,o)}}export class CursorContext{constructor(t,e,r,s){this._cursorContextBrand=void 0,this.model=t,this.viewModel=e,this.coordinatesConverter=r,this.cursorConfig=s}}export class PartialModelCursorState{constructor(t){this.modelState=t,this.viewState=null}}export class PartialViewCursorState{constructor(t){this.modelState=null,this.viewState=t}}export class CursorState{constructor(t,e){this._cursorStateBrand=void 0,this.modelState=t,this.viewState=e}static fromModelState(t){return new PartialModelCursorState(t)}static fromViewState(t){return new PartialViewCursorState(t)}static fromModelSelection(t){const e=t.selectionStartLineNumber,r=t.selectionStartColumn,s=t.positionLineNumber,i=t.positionColumn,o=new SingleCursorState(new Range(e,r,e,r),0,new Position(s,i),0);return CursorState.fromModelState(o)}static fromModelSelections(t){let e=[];for(let r=0,s=t.length;r<s;r++)e[r]=this.fromModelSelection(t[r]);return e}equals(t){return this.viewState.equals(t.viewState)&&this.modelState.equals(t.modelState)}}export class EditOperationResult{constructor(t,e,r){this._editOperationResultBrand=void 0,this.type=t,this.commands=e,this.shouldPushStackElementBefore=r.shouldPushStackElementBefore,this.shouldPushStackElementAfter=r.shouldPushStackElementAfter}}export class CursorColumns{static visibleColumnFromColumn(t,e,r){const s=t.length,i=e-1<s?e-1:s;let o=0,n=0;for(;n<i;){const e=strings.getNextCodePoint(t,i,n);if(n+=e>=65536?2:1,9===e)o=CursorColumns.nextRenderTabStop(o,r);else{let r=strings.getGraphemeBreakType(e);for(;n<i;){const e=strings.getNextCodePoint(t,i,n),s=strings.getGraphemeBreakType(e);if(strings.breakBetweenGraphemeBreakType(r,s))break;n+=e>=65536?2:1,r=s}strings.isFullWidthCharacter(e)||strings.isEmojiImprecise(e)?o+=2:o+=1}}return o}static visibleColumnsByColumns(t,e){const r=t.length;let s=new Array;s.push(-1);let i=0,o=0;for(;o<r;){const n=strings.getNextCodePoint(t,r,o);if(o+=n>=65536?2:1,s.push(i),n>=65536&&s.push(i),9===n)i=CursorColumns.nextRenderTabStop(i,e);else{let e=strings.getGraphemeBreakType(n);for(;o<r;){const a=strings.getNextCodePoint(t,r,o),l=strings.getGraphemeBreakType(a);if(strings.breakBetweenGraphemeBreakType(e,l))break;o+=a>=65536?2:1,s.push(i),n>=65536&&s.push(i),e=l}strings.isFullWidthCharacter(n)||strings.isEmojiImprecise(n)?i+=2:i+=1}}return s.push(i),s}static visibleColumnFromColumn2(t,e,r){return this.visibleColumnFromColumn(e.getLineContent(r.lineNumber),r.column,t.tabSize)}static columnFromVisibleColumn(t,e,r){if(e<=0)return 1;const s=t.length;let i=0,o=1,n=0;for(;n<s;){const a=strings.getNextCodePoint(t,s,n);let l;if(n+=a>=65536?2:1,9===a)l=CursorColumns.nextRenderTabStop(i,r);else{let e=strings.getGraphemeBreakType(a);for(;n<s;){const r=strings.getNextCodePoint(t,s,n),i=strings.getGraphemeBreakType(r);if(strings.breakBetweenGraphemeBreakType(e,i))break;n+=r>=65536?2:1,e=i}l=strings.isFullWidthCharacter(a)||strings.isEmojiImprecise(a)?i+2:i+1}const u=n+1;if(l>=e){return l-e<e-i?u:o}i=l,o=u}return s+1}static columnFromVisibleColumn2(t,e,r,s){let i=this.columnFromVisibleColumn(e.getLineContent(r),s,t.tabSize),o=e.getLineMinColumn(r);if(i<o)return o;let n=e.getLineMaxColumn(r);return i>n?n:i}static nextRenderTabStop(t,e){return t+e-t%e}static nextIndentTabStop(t,e){return t+e-t%e}static prevRenderTabStop(t,e){return Math.max(0,t-1-(t-1)%e)}static prevIndentTabStop(t,e){return Math.max(0,t-1-(t-1)%e)}}export function isQuote(t){return"'"===t||'"'===t||"`"===t}
//# sourceMappingURL=/sm/fc3679d8a462a43220bf1e29104cf8c698498f8f3701149b2dc60fd16292ed2c.map