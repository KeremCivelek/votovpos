/**
 * Minified by jsDelivr using Terser v5.10.0.
 * Original file: /npm/monaco-editor@0.32.1/esm/vs/editor/common/languages/unicodeTextModelHighlighter.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import{Range}from"../core/range.js";import{Searcher}from"../model/textModelSearch.js";import*as strings from"../../../base/common/strings.js";import{assertNever}from"../../../base/common/types.js";export class UnicodeTextModelHighlighter{static computeUnicodeHighlights(e,t,s){const i=s?s.startLineNumber:1,o=s?s.endLineNumber:e.getLineCount(),n=new CodePointHighlighter(t),r=n.getCandidateCodePoints();let a;a="allNonBasicAscii"===r?new RegExp("[^\\t\\n\\r\\x20-\\x7E]","g"):new RegExp(`${buildRegExpCharClassExpr(Array.from(r))}`,"g");const c=new Searcher(null,a),g=[];let h,l=!1,u=0,d=0,C=0;e:for(let t=i,s=o;t<=s;t++){const s=e.getLineContent(t),i=s.length;c.reset(0);do{if(h=c.next(s),h){let e=h.index,o=h.index+h[0].length;if(e>0){const t=s.charCodeAt(e-1);strings.isHighSurrogate(t)&&e--}if(o+1<i){const e=s.charCodeAt(o-1);strings.isHighSurrogate(e)&&o++}const r=s.substring(e,o),a=n.shouldHighlightNonBasicASCII(r);if(0!==a){3===a?u++:2===a?d++:1===a?C++:assertNever(a);const s=1e3;if(g.length>=s){l=!0;break e}g.push(new Range(t,e+1,t,o+1))}}}while(h)}return{ranges:g,hasMore:l,ambiguousCharacterCount:u,invisibleCharacterCount:d,nonBasicAsciiCharacterCount:C}}static computeUnicodeHighlightReason(e,t){const s=new CodePointHighlighter(t);switch(s.shouldHighlightNonBasicASCII(e)){case 0:return null;case 2:return{kind:1};case 3:{const i=e.codePointAt(0),o=s.ambiguousCharacters.getPrimaryConfusable(i),n=strings.AmbiguousCharacters.getLocales().filter((e=>!strings.AmbiguousCharacters.getInstance(new Set([...t.allowedLocales,e])).isAmbiguous(i)));return{kind:0,confusableWith:String.fromCodePoint(o),notAmbiguousInLocales:n}}case 1:return{kind:2}}}}function buildRegExpCharClassExpr(e,t){return`[${strings.escapeRegExpCharacters(e.map((e=>String.fromCodePoint(e))).join(""))}]`}class CodePointHighlighter{constructor(e){this.options=e,this.allowedCodePoints=new Set(e.allowedCodePoints),this.ambiguousCharacters=strings.AmbiguousCharacters.getInstance(new Set(e.allowedLocales))}getCandidateCodePoints(){if(this.options.nonBasicASCII)return"allNonBasicAscii";const e=new Set;if(this.options.invisibleCharacters)for(const t of strings.InvisibleCharacters.codePoints)e.add(t);if(this.options.ambiguousCharacters)for(const t of this.ambiguousCharacters.getConfusableCodePoints())e.add(t);for(const t of this.allowedCodePoints)e.delete(t);return e}shouldHighlightNonBasicASCII(e){const t=e.codePointAt(0);if(this.allowedCodePoints.has(t))return 0;if(this.options.nonBasicASCII)return 1;if(this.options.invisibleCharacters){if(!(" "===e||"\n"===e||"\t"===e)&&strings.InvisibleCharacters.isInvisibleCharacter(t))return 2}return this.options.ambiguousCharacters&&this.ambiguousCharacters.isAmbiguous(t)?3:0}}
//# sourceMappingURL=/sm/cabf54abe573d0ab949d9b87cab4f01ccd95980ff1458e9ef766c8f404effdda.map