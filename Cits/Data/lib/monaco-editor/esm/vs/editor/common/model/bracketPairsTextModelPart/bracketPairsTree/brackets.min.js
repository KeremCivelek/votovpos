/**
 * Minified by jsDelivr using Terser v5.10.0.
 * Original file: /npm/monaco-editor@0.33.0/esm/vs/editor/common/model/bracketPairsTextModelPart/bracketPairsTree/brackets.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import{escapeRegExpCharacters}from"../../../../../base/common/strings.js";import{BracketAstNode}from"./ast.js";import{toLength}from"./length.js";import{identityKeyProvider,SmallImmutableSet}from"./smallImmutableSet.js";import{Token}from"./tokenizer.js";export class BracketTokens{constructor(e){this.map=e,this.hasRegExp=!1,this._regExpGlobal=null}static createFromLanguage(e,t){function r(e,r){return t.getKey(`${e}:::${r}`)}const n=e.characterPair.getColorizedBrackets(),a=new Map,s=new Set;for(const[t,o]of n){s.add(t);let n=a.get(o);const g=r(e.languageId,t);n||(n={openingBrackets:SmallImmutableSet.getEmpty(),first:g},a.set(o,n)),n.openingBrackets=n.openingBrackets.add(g,identityKeyProvider)}const o=new Map;for(const[t,r]of a){const n=toLength(0,t.length);o.set(t,new Token(n,2,r.first,r.openingBrackets,BracketAstNode.create(n,e.languageId,r.openingBrackets)))}for(const t of s){const n=toLength(0,t.length),a=r(e.languageId,t),s=SmallImmutableSet.getEmpty().add(a,identityKeyProvider);o.set(t,new Token(n,1,a,s,BracketAstNode.create(n,e.languageId,s)))}return new BracketTokens(o)}getRegExpStr(){if(this.isEmpty)return null;{const e=[...this.map.keys()];return e.sort(),e.reverse(),e.map((e=>prepareBracketForRegExp(e))).join("|")}}get regExpGlobal(){if(!this.hasRegExp){const e=this.getRegExpStr();this._regExpGlobal=e?new RegExp(e,"g"):null,this.hasRegExp=!0}return this._regExpGlobal}getToken(e){return this.map.get(e)}findClosingTokenText(e){for(const[t,r]of this.map)if(r.bracketIds.intersects(e))return t}get isEmpty(){return 0===this.map.size}}function prepareBracketForRegExp(e){const t=escapeRegExpCharacters(e);return/^[\w ]+$/.test(e)?`\\b${t}\\b`:t}export class LanguageAgnosticBracketTokens{constructor(e,t){this.denseKeyProvider=e,this.getLanguageConfiguration=t,this.languageIdToBracketTokens=new Map}didLanguageChange(e){const t=this.languageIdToBracketTokens.get(e);if(!t)return!1;const r=BracketTokens.createFromLanguage(this.getLanguageConfiguration(e),this.denseKeyProvider).getRegExpStr();return t.getRegExpStr()!==r}getSingleLanguageBracketTokens(e){let t=this.languageIdToBracketTokens.get(e);return t||(t=BracketTokens.createFromLanguage(this.getLanguageConfiguration(e),this.denseKeyProvider),this.languageIdToBracketTokens.set(e,t)),t}}
//# sourceMappingURL=/sm/b9c832083bb894e33eea600b12a34e4e19ae45ae35c13f682318c8c694d4a87d.map